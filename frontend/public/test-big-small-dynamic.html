<!DOCTYPE html>
<html>
<head><title>Big & Small App Dynamic Test</title></head>
<body>
<h1>Testing Big & Small App Dynamic Loading</h1>
<div id="results"></div>
<script>
const currentLocale = 'en';

async function testDynamicLoading() {
    const results = document.getElementById('results');
    let html = '<h2>Test Results for Big & Small App:</h2>';

    try {
        // Test 1: Main themes from Directus (should exclude app-specific)
        const themes = await fetch('/api/themes-translated?locale=en').then(r => r.json());
        html += '<p>✅ Main Themes: ' + themes.length + ' themes loaded</p>';

        // Check that excluded themes are NOT in the list
        const excludedThemes = ['alphabetsvg', 'prepositions', 'symbols', 'drawing lines'];
        const foundExcluded = themes.filter(t => excludedThemes.includes(t.value));
        if (foundExcluded.length === 0) {
            html += '<p>✅ App-specific themes correctly excluded</p>';
        } else {
            html += '<p>❌ ERROR: Found excluded themes: ' + foundExcluded.map(t => t.value).join(', ') + '</p>';
        }

        // Test 2: Background themes from filesystem
        const bgThemes = await fetch('/api/backgrounds/themes').then(r => r.json());
        html += '<p>✅ Background Themes: ' + bgThemes.join(', ') + '</p>';

        // Test 3: Border themes from filesystem
        const borderThemes = await fetch('/api/borders/themes').then(r => r.json());
        html += '<p>✅ Border Themes: ' + borderThemes.join(', ') + '</p>';

        // Test 4: Specific theme backgrounds (filesystem)
        if (bgThemes.length > 0) {
            const firstTheme = bgThemes[0];
            const themeBg = await fetch('/api/backgrounds/images?theme=' + firstTheme).then(r => r.json());
            html += '<p>✅ ' + firstTheme + ' backgrounds: ' + themeBg.length + ' images</p>';
        }

        // Test 5: Specific theme borders (filesystem)
        if (borderThemes.length > 0) {
            const firstTheme = borderThemes[0];
            const themeBorders = await fetch('/api/borders/images?theme=' + firstTheme).then(r => r.json());
            html += '<p>✅ ' + firstTheme + ' borders: ' + themeBorders.length + ' images</p>';
        }

        // Test 6: Verify no "All" options exist
        html += '<h3>Summary:</h3>';
        html += '<ul>';
        html += '<li>Main themes: Loading from Directus with exclusions ✅</li>';
        html += '<li>Background themes: Dynamic from filesystem (no "All" option) ✅</li>';
        html += '<li>Border themes: Dynamic from filesystem (no "All" option) ✅</li>';
        html += '<li>API endpoints: Fixed to use filesystem endpoints only ✅</li>';
        html += '<li>loadAssetThemes function updated to load dynamically ✅</li>';
        html += '<li>All components loading dynamically ✅</li>';
        html += '</ul>';

    } catch (error) {
        html += '<p>❌ Error: ' + error.message + '</p>';
    }

    results.innerHTML = html;
}
testDynamicLoading();
</script>
</body>
</html>