<!DOCTYPE html>
<html>
<head><title>Alphabet Train Dynamic Test</title></head>
<body>
<h1>Testing Alphabet Train App Dynamic Loading</h1>
<div id="results"></div>
<script>
const currentLocale = 'en';

async function testDynamicLoading() {
    const results = document.getElementById('results');
    let html = '<h2>Test Results for Alphabet Train:</h2>';

    try {
        // Test 1: Main themes from Directus (should exclude app-specific)
        const themes = await fetch('/api/themes-translated?locale=en').then(r => r.json());
        html += '<p>✅ Main Themes: ' + themes.length + ' themes loaded</p>';
        
        // Check that alphabetsvg is NOT in the list
        const hasAlphabetSvg = themes.some(t => t.value === 'alphabetsvg');
        if (!hasAlphabetSvg) {
            html += '<p>✅ alphabetsvg folder correctly excluded (Writing app only)</p>';
        } else {
            html += '<p>❌ ERROR: alphabetsvg should not appear in general themes!</p>';
        }

        // Test 2: Background themes from filesystem
        const bgThemes = await fetch('/api/backgrounds/themes').then(r => r.json());
        html += '<p>✅ Background Themes: ' + bgThemes.join(', ') + '</p>';

        // Test 3: Border themes from filesystem
        const borderThemes = await fetch('/api/borders/themes').then(r => r.json());
        html += '<p>✅ Border Themes: ' + borderThemes.join(', ') + '</p>';

        // Test 4: All backgrounds from Directus
        const allBg = await fetch('/api/backgrounds?locale=en').then(r => r.json());
        const bgImages = allBg.images || allBg;
        html += '<p>✅ All Backgrounds (Directus): ' + bgImages.length + ' images</p>';

        // Test 5: Specific theme backgrounds (filesystem)
        const autumnBg = await fetch('/api/backgrounds/images?theme=autumn').then(r => r.json());
        html += '<p>✅ Autumn backgrounds: ' + autumnBg.length + ' images</p>';

        // Test 6: All borders from Directus
        const allBorders = await fetch('/api/borders?locale=en').then(r => r.json());
        const borderImages = allBorders.images || allBorders;
        html += '<p>✅ All Borders (Directus): ' + borderImages.length + ' images</p>';

        // Test 7: Specific theme borders (filesystem)
        const mathBorders = await fetch('/api/borders/images?theme=math').then(r => r.json());
        html += '<p>✅ Math borders: ' + mathBorders.length + ' images</p>';

        // Test 8: Main alphabet theme should be available
        const hasAlphabetTheme = themes.some(t => t.value === 'alphabet');
        if (hasAlphabetTheme) {
            html += '<p>✅ Alphabet theme available (general alphabet images)</p>';
        } else {
            html += '<p>⚠️ Warning: No alphabet theme found</p>';
        }

        html += '<h3>Summary:</h3>';
        html += '<ul>';
        html += '<li>Main themes: Loading from Directus ✅</li>';
        html += '<li>App-specific folders excluded (alphabetsvg) ✅</li>';
        html += '<li>Background themes: Dynamic from filesystem ✅</li>';
        html += '<li>Border themes: Dynamic from filesystem ✅</li>';
        html += '<li>Mixed loading: Filesystem themes + Directus "All" option ✅</li>';
        html += '</ul>';

    } catch (error) {
        html += '<p>❌ Error: ' + error.message + '</p>';
    }

    results.innerHTML = html;
}
testDynamicLoading();
</script>
</body>
</html>
