<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test New Architecture - LessonCraftStudio</title>

    <!-- Load the new centralized system -->
    <script src="js/translations.js"></script>
    <script src="js/locale-manager.js"></script>
    <script src="js/app-initializer.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .control-panel {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        select {
            padding: 8px;
            margin: 5px;
            min-width: 200px;
        }
        .status {
            background: #e8f5e9;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        .image-item {
            border: 1px solid #ddd;
            padding: 5px;
            text-align: center;
        }
        .image-item img {
            max-width: 100%;
            height: 80px;
            object-fit: contain;
        }
    </style>
</head>
<body>
    <h1>New Architecture Test - Professional & Reliable</h1>

    <div class="status">
        <strong>Current Locale:</strong> <span id="currentLocale">Loading...</span>
    </div>

    <div class="control-panel">
        <h2>Theme Selectors (Automatically Localized)</h2>

        <label>Border Theme:
            <select id="borderThemeSelect">
                <option>Loading...</option>
            </select>
        </label>

        <label>Background Theme:
            <select id="backgroundThemeSelect">
                <option>Loading...</option>
            </select>
        </label>

        <label>Image Theme:
            <select id="themeSelect">
                <option>Loading...</option>
            </select>
        </label>
    </div>

    <div class="control-panel">
        <h2>Test Different Languages</h2>
        <button onclick="changeLocale('en')">English</button>
        <button onclick="changeLocale('sv')">Svenska</button>
        <button onclick="changeLocale('de')">Deutsch</button>
        <button onclick="changeLocale('fr')">Français</button>
        <button onclick="changeLocale('es')">Español</button>
    </div>

    <div id="imageGrid" class="image-grid"></div>

    <script>
    // THIS IS THE ENTIRE APP CODE - NOTICE HOW CLEAN IT IS!

    document.addEventListener('DOMContentLoaded', async function() {
        // Display current locale
        document.getElementById('currentLocale').textContent = LocaleManager.getLocale();

        // Initialize all common functionality with ONE line
        await AppInitializer.init({
            borderThemeSelect: 'borderThemeSelect',
            backgroundThemeSelect: 'backgroundThemeSelect',
            themeSelect: 'themeSelect'
        });

        // Load images when theme changes
        document.getElementById('themeSelect').addEventListener('change', loadImages);

        // Load initial images
        loadImages();
    });

    // Load and display images
    async function loadImages() {
        const theme = document.getElementById('themeSelect').value;
        const images = await AppInitializer.loadImages(theme);

        const grid = document.getElementById('imageGrid');
        grid.innerHTML = '';

        images.slice(0, 12).forEach(img => {
            const div = document.createElement('div');
            div.className = 'image-item';
            div.innerHTML = `
                <img src="${img.url || img.path}" alt="${img.name}">
                <div>${img.name}</div>
            `;
            grid.appendChild(div);
        });
    }

    // Change locale for testing
    function changeLocale(locale) {
        const url = new URL(window.location);
        url.searchParams.set('locale', locale);
        window.location.href = url.toString();
    }
    </script>
</body>
</html>