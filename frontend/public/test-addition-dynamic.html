<!DOCTYPE html>
<html>
<head><title>Addition App Dynamic Test</title></head>
<body>
<h1>Testing Addition App Dynamic Loading</h1>
<div id="results"></div>
<script>
const currentLocale = 'en';

async function testDynamicLoading() {
    const results = document.getElementById('results');
    let html = '<h2>Test Results:</h2>';

    try {
        // Test 1: Main themes from Directus
        const themes = await fetch('/api/themes-translated?locale=en').then(r => r.json());
        html += '<p>✅ Main Themes: ' + themes.length + ' themes loaded (from Directus)</p>';
        
        // List excluded themes that should NOT appear
        const excludedThemes = ['alphabetsvg', 'prepositions', 'symbols', 'drawing lines'];
        const foundExcluded = themes.filter(t => excludedThemes.includes(t.value));
        if (foundExcluded.length === 0) {
            html += '<p>✅ Excluded app-specific themes are properly filtered out</p>';
        } else {
            html += '<p>❌ Found excluded themes: ' + foundExcluded.map(t => t.value).join(', ') + '</p>';
        }

        // Test 2: Background themes from filesystem
        const bgThemes = await fetch('/api/backgrounds/themes').then(r => r.json());
        html += '<p>✅ Background Themes (filesystem): ' + bgThemes.join(', ') + '</p>';

        // Test 3: Border themes from filesystem
        const borderThemes = await fetch('/api/borders/themes').then(r => r.json());
        html += '<p>✅ Border Themes (filesystem): ' + borderThemes.join(', ') + '</p>';

        // Test 4: All backgrounds from Directus
        const allBg = await fetch('/api/backgrounds?locale=en').then(r => r.json());
        const bgImages = allBg.images || allBg;
        html += '<p>✅ All Backgrounds (Directus): ' + bgImages.length + ' images</p>';

        // Test 5: All borders from Directus
        const allBorders = await fetch('/api/borders?locale=en').then(r => r.json());
        const borderImages = allBorders.images || allBorders;
        html += '<p>✅ All Borders (Directus): ' + borderImages.length + ' images</p>';

        // Test 6: Specific theme backgrounds
        const autumnBg = await fetch('/api/backgrounds/images?theme=autumn').then(r => r.json());
        html += '<p>✅ Autumn backgrounds (filesystem): ' + autumnBg.length + ' images</p>';

        // Test 7: Specific theme borders
        const mathBorders = await fetch('/api/borders/images?theme=math').then(r => r.json());
        html += '<p>✅ Math borders (filesystem): ' + mathBorders.length + ' images</p>';

        html += '<h3>Summary for Addition App:</h3>';
        html += '<ul>';
        html += '<li>Main themes: Loading from Directus with app-specific exclusions ✅</li>';
        html += '<li>Background themes: Loading dynamically from filesystem ✅</li>';
        html += '<li>Border themes: Loading dynamically from filesystem ✅</li>';
        html += '<li>"All Backgrounds": Loading from Directus ✅</li>';
        html += '<li>"All Borders": Loading from Directus ✅</li>';
        html += '<li>Specific themes: Loading from filesystem ✅</li>';
        html += '</ul>';

    } catch (error) {
        html += '<p>❌ Error: ' + error.message + '</p>';
    }

    results.innerHTML = html;
}
testDynamicLoading();
</script>
</body>
</html>
