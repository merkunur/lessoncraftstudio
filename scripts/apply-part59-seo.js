/**
 * SEO Part 59: Enrich preschool grade for winter, holidays, easter, halloween, xmas
 * Adds 6 grade-level enrichment fields to gradeContent.preschool for each theme.
 * Fields: uniqueGradeAngle, developmentalMilestones, differentiationNotes,
 *         parentTakeaway, classroomIntegration, assessmentRubric
 */
const fs = require('fs');
const path = require('path');

const BASE = path.join(__dirname, '..', 'frontend', 'content', 'themes');

// Escape single quotes for TS single-quoted strings
function esc(s) {
  return s.replace(/'/g, "\\'");
}

function buildInjection(data, nl) {
  const lines = [];
  lines.push(`      uniqueGradeAngle: '${esc(data.uniqueGradeAngle)}',`);
  lines.push(`      developmentalMilestones: [`);
  for (const m of data.developmentalMilestones) {
    lines.push(`        { milestone: '${esc(m.milestone)}', howWeAddress: '${esc(m.howWeAddress)}' },`);
  }
  lines.push(`      ],`);
  lines.push(`      differentiationNotes: '${esc(data.differentiationNotes)}',`);
  lines.push(`      parentTakeaway: '${esc(data.parentTakeaway)}',`);
  lines.push(`      classroomIntegration: '${esc(data.classroomIntegration)}',`);
  lines.push(`      assessmentRubric: [`);
  for (const r of data.assessmentRubric) {
    lines.push(`        { skill: '${esc(r.skill)}', emerging: '${esc(r.emerging)}', proficient: '${esc(r.proficient)}', advanced: '${esc(r.advanced)}' },`);
  }
  lines.push(`      ],`);
  return lines.join(nl);
}

// ── Theme content ────────────────────────────────────────────────────────

const themes = [
  // ── Winter ──────────────────────────────────────────────────────────
  {
    name: 'winter',
    uniqueGradeAngle: 'Preschool is the most transformative stage for winter worksheets because three- and four-year-olds experience winter as the most dramatically different season from their baseline \u2014 the sudden appearance of snow, ice, bare trees, cold temperatures, and early darkness creates a world that looks, feels, and sounds completely unlike the environment they knew just weeks before, and this radical environmental change triggers the deepest observation and questioning impulse of any seasonal theme. Winter is uniquely powerful at the preschool level because the sensory contrasts are the most extreme of any season: hot cocoa versus freezing air, soft snow versus hard ice, thick coats versus light summer clothes, dark mornings versus bright snow-reflected light. These dramatic contrasts make comparison vocabulary development effortless because children do not need to be taught that cold is different from hot when their fingers are freezing and their cocoa is steaming. Winter also introduces the concept of preparation and planning in a way no other season does, because getting dressed for winter requires multiple layers, specific items, and a sequence that must be followed correctly \u2014 building executive function skills through a daily routine that is dramatically more complex than any other time of year.',
    developmentalMilestones: [
      { milestone: 'Extreme sensory contrast vocabulary (preschoolers are developing the ability to describe opposites and comparisons)', howWeAddress: 'winter provides the most dramatic sensory contrasts of any season with hot versus cold, soft versus hard, dark versus bright, and thick versus thin, making comparison vocabulary acquisition effortless because children experience these extremes through direct daily sensation' },
      { milestone: 'Multi-step dressing sequences and executive function (preschoolers are developing the ability to follow multi-step procedures in correct order)', howWeAddress: 'winter dressing requires the most complex daily sequence of any season with underwear, then shirt, then sweater, then coat, then hat, then mittens, then boots, building procedural memory and sequential planning through an unavoidable daily routine' },
      { milestone: 'Transformation observation through freezing and melting (preschoolers are beginning to understand that materials can change form)', howWeAddress: 'winter provides the most accessible, repeatable, and reversible transformation experiment available because children can watch water freeze into ice and ice melt back into water, building the foundational understanding that matter changes form' },
    ],
    differentiationNotes: 'For struggling preschoolers, focus on three high-contrast winter elements (snow, mittens, hot cocoa) and bring real sensory props into worksheet time such as ice cubes to touch, a warm mug to hold, and a mitten to wear while working; reduce dressing sequence activities to two steps before introducing longer chains. For advanced preschoolers, introduce a classroom freezing and melting experiment alongside winter worksheets where children predict what will happen to ice left on a plate, extend counting to winter scenes with ten or more snowflakes or icicles, and challenge children to describe the complete winter dressing sequence using ordinal words like first, second, third, and last.',
    parentTakeaway: 'Winter worksheets give preschool parents the most powerful sensory contrast learning tool of any seasonal theme because winter creates extremes that teach themselves \u2014 your child does not need worksheets to know that snow is cold, but worksheets give them the vocabulary and framework to describe, compare, and reason about what they already feel. The single most effective winter learning activity costs nothing: fill two cups, put one outside and one inside, and check them after an hour. When your child sees one has turned to ice and the other has not, they have just completed their first real science experiment with observable, touchable results. Pair this with a winter worksheet about ice and water, and the paper-to-reality connection will be the strongest of any theme because the transformation is dramatic, reversible, and infinitely repeatable.',
    classroomIntegration: 'Winter worksheets anchor a preschool thematic unit built around sensory contrast exploration and daily routine complexity. Set up a classroom winter sensory station with bowls of snow or ice, warm water, cotton balls for pretend snow, and textured fabric scraps representing winter clothing materials. Use winter coloring pages as morning arrival activities while children transition from heavy outdoor gear to indoor comfort, creating a natural thematic entry point every single morning. Incorporate counting worksheets into a small-group math rotation where children count mittens, snowflakes, and icicles, and connect dressing sequence activities to the actual getting-dressed routine that happens twice daily during winter months. A classroom ice observation station where children watch ice cubes melt and record what they see provides the most accessible ongoing science experiment of any theme. Movement activities where children shiver like cold trees, stomp through pretend snow, and huddle together for warmth bridge worksheet concepts to gross motor development while reinforcing winter vocabulary through embodied experience.',
    assessmentRubric: [
      { skill: 'Winter sensory contrast vocabulary', emerging: 'names one winter sensation like cold when touching ice with teacher prompting', proficient: 'independently uses three or more contrast pairs like hot and cold or soft and hard when describing winter items and experiences', advanced: 'uses contrast vocabulary in complete comparison sentences like the snow is cold and soft but the ice is cold and hard, and applies contrast words to non-winter contexts' },
      { skill: 'Winter dressing sequence', emerging: 'identifies the first item to put on in a two-step winter dressing sequence with picture support', proficient: 'correctly orders a four-step winter dressing sequence and uses the words first, then, and last to describe the order', advanced: 'orders five or more steps, explains why the sequence matters like you put mittens on last because you need your fingers to zip your coat, and identifies errors in an incorrect sequence' },
      { skill: 'Counting winter objects', emerging: 'counts to 3 winter items like snowflakes or mittens with one-to-one correspondence using physical pointing', proficient: 'counts to 7 winter items reliably, identifies the matching numeral, and uses winter context words like five snowflakes', advanced: 'counts to 10+, compares two winter groups, and uses comparison vocabulary like there are more snowflakes than icicles in this picture' },
    ],
  },

  // ── Holidays ────────────────────────────────────────────────────────
  {
    name: 'holidays',
    uniqueGradeAngle: 'Preschool is the most emotionally powerful stage for holiday worksheets because three- and four-year-olds experience holidays as the most exciting, anticipated, and memorable events in their entire year \u2014 the heightened emotional state surrounding celebrations creates a neurological environment where learning happens faster, embeds deeper, and persists longer than during any ordinary instructional period. Holidays are uniquely effective at the preschool level because they combine every developmental domain simultaneously: counting candles and gifts exercises math skills, recognizing holiday symbols builds visual literacy, following celebration sequences develops temporal reasoning, and participating in family traditions builds social-emotional understanding. The cross-cultural breadth of the holidays theme also introduces preschoolers to the concept that different families celebrate in different ways, building the foundation for cultural awareness and respect during the developmental window when children are forming their understanding of how the social world works.',
    developmentalMilestones: [
      { milestone: 'Anticipation and temporal reasoning through countdown activities (preschoolers are developing the ability to think about future events and track time passing)', howWeAddress: 'holiday countdown worksheets and calendar activities introduce the concept that exciting events are coming and can be tracked day by day, building the future-oriented thinking that supports planning, patience, and delayed gratification' },
      { milestone: 'Cultural symbol recognition and meaning-making (preschoolers are developing the ability to understand that images represent ideas)', howWeAddress: 'holiday symbols like candles, hearts, stars, and decorated eggs are among the first symbols children learn to associate with abstract concepts like love, celebration, and gratitude, building the symbolic reasoning that later supports letter-sound connections and mathematical notation' },
      { milestone: 'Gift counting and sharing concepts (preschoolers are building one-to-one correspondence and early social-emotional reasoning)', howWeAddress: 'holiday worksheets featuring gift-giving scenarios naturally combine counting practice with sharing concepts, teaching both mathematical accuracy and social-emotional skills through the most motivating context available' },
    ],
    differentiationNotes: 'For struggling preschoolers, focus on three universally familiar holiday elements (cake, balloons, presents) that appear across many celebrations and pair every worksheet with real celebration props like a wrapped empty box, a balloon, and a party hat to create immediate tactile connections; reduce counting to sets of three or fewer and use large, bright illustrations. For advanced preschoolers, introduce the concept that different holidays have different symbols and ask children to sort holiday items by celebration type, extend counting to party scenes with ten or more guests or gifts, and encourage children to describe their own family holiday traditions using complete sentences that include temporal words like first we decorate and then we eat together.',
    parentTakeaway: 'Holiday worksheets give preschool parents the most emotionally charged learning opportunity of the entire year because children are already in a state of heightened attention and excitement around celebrations. The key insight is that this excitement is not a distraction from learning \u2014 it is a learning accelerator. When your child is thrilled about an upcoming birthday party or holiday celebration, their brain is in a state of elevated engagement that makes counting, matching, and pattern recognition stick faster and longer than during calm instructional moments. Use holiday worksheets in the days leading up to celebrations when anticipation is highest, and connect every worksheet to the real celebration by asking questions like how many candles will be on the cake and what shapes do you see in our decorations. This transforms holiday preparation from a logistics task into a rich, multi-day learning experience.',
    classroomIntegration: 'Holiday worksheets integrate into preschool programming as naturally recurring thematic anchors spaced throughout the school year, providing predictable excitement peaks that reset student engagement every few weeks. Create a rotating holiday display area that changes with each celebration, featuring children\u0027s completed worksheets alongside real holiday items and decorations. Use holiday coloring pages as arrival activities during celebration weeks, incorporate counting worksheets into a small-group math rotation where children count candles, gifts, or decorations using real objects, and connect sorting activities to a classroom celebration comparison chart where children explore how different holidays share common elements like special food, decorations, and family gatherings. A classroom party planning activity where children help count plates, cups, and napkins for a real classroom celebration provides the most authentic mathematical application of any theme, connecting worksheet counting to genuine, meaningful real-world use.',
    assessmentRubric: [
      { skill: 'Holiday symbol recognition and vocabulary', emerging: 'names two common holiday items like cake and balloon from illustrations with teacher prompting', proficient: 'independently names four or more holiday items, identifies which celebration they belong to, and describes one thing that happens during that celebration', advanced: 'names multiple items across several holidays, compares celebrations by describing similarities and differences, and explains what holidays mean to their own family' },
      { skill: 'Counting holiday objects', emerging: 'counts to 3 holiday items like candles or gifts with one-to-one correspondence using physical pointing', proficient: 'counts to 7 holiday items reliably, identifies the matching numeral, and uses celebration context words like five birthday candles', advanced: 'counts to 10+, compares two holiday groups, and solves simple holiday story problems like if we have six cupcakes and three children how many does each child get' },
      { skill: 'Holiday sequence understanding', emerging: 'identifies what happens first in a two-step celebration sequence like decorate then eat cake with picture support', proficient: 'correctly orders a three-step holiday sequence and uses the words first, then, and last to describe the order', advanced: 'orders three or more steps, explains reasoning, and describes their own family celebration sequence using temporal vocabulary' },
    ],
  },

  // ── Easter ──────────────────────────────────────────────────────────
  {
    name: 'easter',
    uniqueGradeAngle: 'Preschool is the perfect stage for Easter worksheets because three- and four-year-olds are in the peak period of pattern recognition development, and Easter provides the most visually stunning, hands-on pattern practice available in any holiday theme \u2014 decorating eggs with stripes, dots, zigzags, and color sequences creates a pattern laboratory that transforms abstract mathematical concepts into beautiful, tangible art. Easter is uniquely powerful at the preschool level because it combines three skills simultaneously: fine motor control through egg decorating precision, pattern recognition through repeating designs, and color vocabulary through the pastel palette that defines the holiday. The egg hunt tradition adds a spatial reasoning and search strategy dimension that no other holiday provides, teaching children to scan environments systematically, remember where they have already looked, and persist through the challenge of finding hidden objects \u2014 all skills that directly support later reading and mathematical problem-solving.',
    developmentalMilestones: [
      { milestone: 'Pattern recognition and creation through egg decoration (preschoolers are developing the ability to identify, continue, and create repeating patterns)', howWeAddress: 'Easter egg decorating worksheets provide the most naturally motivating pattern practice because children create beautiful, displayable results while practicing AB, ABB, and ABC patterns with colors, shapes, and lines on the most satisfying canvas available \u2014 the smooth oval of an egg' },
      { milestone: 'Spatial search strategies through egg hunt activities (preschoolers are developing systematic visual scanning and spatial memory)', howWeAddress: 'Easter egg hunt worksheets and activities teach children to search environments methodically by checking different areas, remembering where they have looked, and tracking how many they have found, building the spatial reasoning and working memory that support reading and mathematics' },
      { milestone: 'Fine motor precision through small-area decoration (preschoolers are developing controlled hand movements within defined boundaries)', howWeAddress: 'Easter egg coloring and decorating activities require the most precise fine motor control of any holiday theme because the oval shape demands careful boundary awareness and the small decorative elements require controlled, deliberate strokes' },
    ],
    differentiationNotes: 'For struggling preschoolers, start with large egg outlines and two-color AB patterns (blue stripe, yellow stripe, blue stripe) before introducing more complex pattern types, use real hard-boiled eggs alongside paper worksheets so children can rotate the three-dimensional object while working on the two-dimensional illustration, and reduce egg hunt counting to sets of three or fewer. For advanced preschoolers, introduce three-element ABC patterns on eggs, challenge children to create their own original pattern and describe the rule, extend egg hunt worksheets to scenes with ten or more hidden eggs requiring careful visual scanning, and ask children to sort collected eggs by pattern type or color family.',
    parentTakeaway: 'Easter worksheets give preschool parents the most seamless holiday-to-learning connection because the core Easter activities \u2014 decorating eggs and hunting for them \u2014 ARE learning activities disguised as fun. When your child decorates a real egg with stripes and dots, they are practicing the same patterns they see on worksheets. When they search for hidden eggs, they are using the same spatial scanning and counting skills. The key parent action is simply to narrate the learning while it happens: say what pattern are you making on that egg or how many eggs have you found so far \u2014 count them with me. This transforms an already-beloved holiday tradition into deliberate practice without reducing any of the joy. Keep a few decorated eggs on display after Easter and use them as counting and pattern review tools for weeks afterward.',
    classroomIntegration: 'Easter worksheets anchor a preschool thematic unit centered on patterns, spatial reasoning, and spring renewal that naturally bridges holiday excitement to core academic skills. Create a classroom egg decorating station with large paper egg cutouts, dot markers, and crayons organized by color for pattern-making practice alongside worksheets. Use Easter coloring pages as morning arrival activities, incorporate pattern worksheets into a small-group math rotation where children extend patterns on paper eggs using colored stickers, and connect counting activities to a classroom egg hunt where children find hidden paper eggs around the room and count their collection. A sorting station where children organize decorated eggs by pattern type (stripes, dots, zigzags) or by color builds classification skills. Easter basket packing activities where children count specific numbers of items into baskets provide authentic one-to-one correspondence practice with highly motivating materials.',
    assessmentRubric: [
      { skill: 'Easter pattern recognition', emerging: 'identifies that an egg has a repeating element like lots of stripes with teacher prompting', proficient: 'independently identifies and continues a two-element AB pattern on an egg and names the colors or shapes in the pattern', advanced: 'identifies AB and ABC patterns, creates an original pattern, and describes the pattern rule like it goes blue dot then yellow dot then blue dot and it keeps repeating' },
      { skill: 'Counting Easter objects', emerging: 'counts to 3 eggs or bunnies with one-to-one correspondence using physical pointing', proficient: 'counts to 7 Easter items reliably, identifies the matching numeral, and uses Easter context words like five decorated eggs', advanced: 'counts to 10+, compares two groups of Easter items, and tracks a running count during an egg hunt activity' },
      { skill: 'Easter fine motor and decoration', emerging: 'applies color to a large egg outline with whole-arm strokes and frequent boundary crossing', proficient: 'colors within egg outlines using wrist-based strokes and attempts to create a simple pattern with two colors', advanced: 'decorates eggs with controlled strokes, creates recognizable patterns, and adds small decorative details like dots and zigzags with deliberate placement' },
    ],
  },

  // ── Halloween ───────────────────────────────────────────────────────
  {
    name: 'halloween',
    uniqueGradeAngle: 'Preschool is the ideal stage for Halloween worksheets because three- and four-year-olds are in the critical period of emotional regulation development, and Halloween provides the most unique opportunity available in any theme to practice managing mild excitement, anticipation, and the thrilling-but-safe boundary between fun-scary and real-scary. No other theme gives preschoolers this carefully calibrated emotional experience, where friendly ghosts, smiling pumpkins, and cartoon bats let children practice feeling a little thrill while remaining completely safe \u2014 building the emotional flexibility and coping skills that support all future encounters with new, uncertain, or mildly challenging situations. Halloween is also uniquely powerful for preschool academics because the iconic imagery \u2014 jack-o-lantern faces with geometric features, symmetrical spider webs, the crescent moon \u2014 provides some of the most visually distinctive and geometrically rich illustrations available in any theme, making shape recognition, symmetry awareness, and facial feature identification dramatically effective.',
    developmentalMilestones: [
      { milestone: 'Emotional vocabulary and regulation through safe-scary experiences (preschoolers are developing the ability to name, understand, and manage their emotions)', howWeAddress: 'Halloween worksheets with friendly monster faces, smiling ghosts, and cartoon bats give children the vocabulary and visual context to discuss feelings like excited, surprised, and a little scared in a completely safe environment, building emotional literacy through the only theme that deliberately explores the mild-fear-to-delight spectrum' },
      { milestone: 'Facial feature recognition and creation through jack-o-lantern design (preschoolers are developing the ability to identify, name, and draw facial features)', howWeAddress: 'pumpkin face worksheets where children add eyes, nose, and mouth to blank pumpkins provide the most motivating facial feature practice available because children get to design their own character face, building both facial recognition skills and creative expression simultaneously' },
      { milestone: 'Counting with costume and candy motivation (preschoolers need strong emotional engagement to sustain counting practice)', howWeAddress: 'Halloween counting worksheets featuring candy, costumes, and trick-or-treat bags leverage the most anticipated event of the preschool year, producing engagement levels that sustain counting practice far beyond what any non-holiday theme can achieve' },
    ],
    differentiationNotes: 'For struggling preschoolers, focus exclusively on friendly, non-scary Halloween imagery (smiling pumpkins, friendly cats, colorful candy) and pair every worksheet with a real pumpkin or Halloween prop that children can touch; reduce facial feature activities to placing two pre-cut eyes on a pumpkin before introducing nose and mouth, and keep counting sets to three or fewer. For advanced preschoolers, introduce symmetry through spider web worksheets where children complete the matching half, extend counting to trick-or-treat scenes with ten or more candy items, and challenge children to design their own jack-o-lantern face and describe the emotions their pumpkin is showing using facial feature vocabulary like my pumpkin has triangle eyes and a big smile so it looks happy and surprised.',
    parentTakeaway: 'Halloween worksheets give preschool parents a unique emotional learning opportunity that no other theme can replicate \u2014 the chance to help your child practice being excited about something mildly thrilling while learning that fun-scary is different from real-scary. When your child colors a friendly ghost or designs a jack-o-lantern face, ask them how the character is feeling and how it makes them feel. This simple conversation builds emotional vocabulary and self-awareness through the most engaging context of the year. For the academic connection, involve your child in real pumpkin carving by asking them to choose the face shape (triangle eyes or circle eyes, happy mouth or surprised mouth), turning a family tradition into a geometry and emotional expression lesson. Count trick-or-treat candy together after Halloween night for the most motivating math practice session of the entire year.',
    classroomIntegration: 'Halloween worksheets anchor a preschool thematic unit that uniquely combines emotional learning with academic skills, providing the most naturally cross-domain instruction of any holiday theme. Create a pumpkin face design station where children arrange magnetic or felt facial features on a large pumpkin cutout before completing face-design worksheets. Use Halloween coloring pages as morning arrival activities during October, incorporate counting worksheets into a small-group math rotation where children count plastic spiders, candy corn pieces, and mini pumpkins, and connect shape recognition activities to a jack-o-lantern geometry chart showing triangles, circles, and crescents in pumpkin face designs. A classroom costume parade provides vocabulary practice as children describe what they see. A Halloween sensory bin with dried pasta shapes, plastic spiders, and small pumpkins extends sorting and counting into tactile exploration. The emotional learning dimension \u2014 discussing what is fun-scary versus real-scary \u2014 makes Halloween the only theme that naturally integrates social-emotional curriculum into every academic activity.',
    assessmentRubric: [
      { skill: 'Halloween facial feature and shape recognition', emerging: 'identifies one facial feature like eyes on a jack-o-lantern with teacher prompting', proficient: 'independently names all three facial features on a pumpkin face and identifies the shapes used like triangle eyes and circle nose', advanced: 'names features, identifies shapes, describes the emotion the face shows, and designs an original face with deliberate shape and emotion choices' },
      { skill: 'Counting Halloween objects', emerging: 'counts to 3 Halloween items like candy or pumpkins with one-to-one correspondence using physical pointing', proficient: 'counts to 7 Halloween items reliably, identifies the matching numeral, and sorts counted objects into groups like candy versus decorations', advanced: 'counts to 10+, compares two Halloween groups, and solves simple Halloween story problems like if you have eight pieces of candy and give three to your friend how many are left' },
      { skill: 'Halloween emotional vocabulary', emerging: 'names one emotion like happy when looking at a friendly jack-o-lantern face with teacher prompting', proficient: 'names three or more emotions from different Halloween character faces and connects facial features to emotions like the big eyes make it look surprised', advanced: 'names multiple emotions, explains which facial features create each emotion, and describes their own emotional response to Halloween imagery using phrases like the friendly ghost makes me feel excited not scared' },
    ],
  },

  // ── Christmas ───────────────────────────────────────────────────────
  {
    name: 'xmas',
    uniqueGradeAngle: 'Preschool is the most impactful stage for Christmas worksheets because three- and four-year-olds experience the Christmas season with a depth of wonder, anticipation, and sensory immersion that is unmatched at any other age or any other time of year \u2014 the lights, music, decorations, gift-giving, tree decorating, and countdown create the most multi-sensory, extended-duration thematic experience available in early childhood education. Christmas is uniquely powerful at the preschool level because it naturally sustains thematic engagement for three to four weeks rather than a single day, providing the longest continuous motivational arc of any holiday and enabling a progressive worksheet sequence that builds skills over an extended period. The tradition of decorating Christmas trees with ornaments of varying sizes, shapes, and colors creates the most naturally rich sorting and patterning activity available in any theme, while gift counting and sharing provide authentic, emotionally meaningful contexts for one-to-one correspondence and early addition concepts.',
    developmentalMilestones: [
      { milestone: 'Extended anticipation and countdown skills (preschoolers are developing the ability to track time over multiple days and manage excitement about future events)', howWeAddress: 'Christmas advent calendars and countdown worksheets build the most sustained temporal tracking experience of the year, teaching children that time passes in a predictable sequence and that waiting can be structured through daily marking and counting activities' },
      { milestone: 'Ornament sorting and classification through tree decorating (preschoolers are developing multi-attribute sorting skills)', howWeAddress: 'Christmas tree decorating activities where children sort ornaments by color, size, and shape provide the most naturally motivating classification practice because the end result is a beautiful decorated tree, giving children both academic rigor and aesthetic satisfaction simultaneously' },
      { milestone: 'Generous counting through gift-giving contexts (preschoolers are developing one-to-one correspondence alongside social-emotional concepts of sharing)', howWeAddress: 'Christmas worksheets featuring gift distribution scenarios naturally combine counting accuracy with the concept of giving, teaching children to count items for others rather than only for themselves, building both mathematical precision and prosocial reasoning' },
    ],
    differentiationNotes: 'For struggling preschoolers, focus on three immediately recognizable Christmas elements (Christmas tree, star, gift) and use real ornaments and small wrapped boxes as manipulatives alongside every worksheet; reduce sorting to two categories (big ornaments versus small ornaments) before introducing three-attribute sorts, and keep counting to sets of five or fewer. For advanced preschoolers, introduce Christmas tree symmetry activities where children decorate both halves of a tree to match, extend counting to gift-giving word problems like if there are four children and each gets two presents how many presents do we need, and challenge children to create and describe their own ornament patterns using three or more colors or shapes.',
    parentTakeaway: 'Christmas worksheets give preschool parents the most extended and naturally immersive learning opportunity of the entire year because the Christmas season sustains excitement and engagement for weeks rather than hours. The single most powerful learning strategy is to make your child an active participant in every Christmas preparation activity rather than a passive observer: let them count ornaments as you hang them, sort decorations by color before they go on the tree, count gifts under the tree each day and notice when the number increases, and help wrap presents by counting sheets of paper and lengths of ribbon. Every one of these real-world activities directly mirrors worksheet skills, and the emotional significance of Christmas preparations creates memory pathways that are among the strongest your child will form all year. An advent calendar where your child marks off each day builds the longest sustained counting and temporal tracking exercise available at the preschool level.',
    classroomIntegration: 'Christmas worksheets anchor the most extended thematic unit of the preschool year, spanning three to four weeks of progressively complex activities that build on each other. Create a classroom Christmas tree decorating station where children sort ornaments by attribute before hanging them, directly paralleling the sorting skills practiced on worksheets. Use Christmas coloring pages as morning arrival activities throughout December, incorporate counting worksheets into a small-group math rotation where children count ornaments, gifts, and gingerbread cookies using real or realistic objects, and connect pattern activities to a paper chain decoration project where children create AB and ABC color patterns that grow longer each day. A classroom advent calendar provides the most authentic daily counting and anticipation-tracking activity available. A gift-wrapping station where children measure and cut paper, count ribbon pieces, and attach gift tags integrates fine motor skills, measurement concepts, and counting into a single purposeful activity. The generosity theme creates natural social-emotional learning connections through classroom gift exchanges and discussions about giving.',
    assessmentRubric: [
      { skill: 'Christmas sorting and classification', emerging: 'sorts ornaments into two groups by one attribute like red versus green with teacher modeling', proficient: 'independently sorts ornaments or decorations by color, size, or shape and names each group', advanced: 'sorts by one attribute, re-sorts by a different attribute, explains both sorting rules, and identifies items that could fit multiple categories like a big red star is both big and red' },
      { skill: 'Counting Christmas objects', emerging: 'counts to 3 Christmas items like ornaments or gifts with one-to-one correspondence using physical pointing', proficient: 'counts to 7 Christmas items reliably, identifies the matching numeral, and tracks growing quantities like there are more presents today than yesterday', advanced: 'counts to 10+, compares groups, and solves simple gift distribution problems like giving two ornaments to each of three children' },
      { skill: 'Christmas pattern creation', emerging: 'identifies that a decoration has a repeating element like red and green with teacher prompting', proficient: 'independently continues a two-element AB pattern and names the colors or shapes in the sequence', advanced: 'creates original AB and ABC patterns, describes the pattern rule, and applies pattern concepts to real decorating activities like arranging candy canes and ornaments in an alternating pattern' },
    ],
  },
];

// ── Injection ────────────────────────────────────────────────────────────

let successCount = 0;

for (const theme of themes) {
  const filePath = path.join(BASE, theme.name, 'en.ts');
  let content = fs.readFileSync(filePath, 'utf8');

  // Detect line endings
  const nl = content.includes('\r\n') ? '\r\n' : '\n';

  // Build injection block
  const injection = buildInjection(theme, nl);

  // Pattern: end of faq array ], then close preschool }, then 'kindergarten':
  // Uses a regex that handles both \n and \r\n
  const pattern = /(      \],)\r?\n(    \},)\r?\n(    'kindergarten':)/;

  if (!pattern.test(content)) {
    console.error(`ERROR: Injection pattern not found in ${theme.name}/en.ts`);
    process.exit(1);
  }

  // Check if already injected
  if (content.includes("uniqueGradeAngle: '") && content.indexOf("uniqueGradeAngle: '") < content.indexOf("'kindergarten':")) {
    console.log(`SKIP: ${theme.name}/en.ts already has uniqueGradeAngle in preschool section`);
    continue;
  }

  content = content.replace(pattern, `$1${nl}${injection}${nl}$2${nl}$3`);

  fs.writeFileSync(filePath, content, 'utf8');
  successCount++;
  console.log(`OK: Injected 6 preschool fields into ${theme.name}/en.ts`);
}

console.log(`\nDone! ${successCount} of ${themes.length} themes enriched.`);
