<!DOCTYPE html>
<html>
<head>
    <title>Test Math Translations</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Math Worksheet Translation Test</h1>
    
    <div class="test-section">
        <h2>Testing Different Locales</h2>
        <button onclick="testLocale('en')">Test English</button>
        <button onclick="testLocale('de')">Test German</button>
        <button onclick="testLocale('fr')">Test French</button>
    </div>
    
    <div id="results"></div>
    
    <div class="test-section">
        <h2>Direct iFrame Test</h2>
        <label>Select Language: 
            <select onchange="updateIframe(this.value)">
                <option value="en">English</option>
                <option value="de">German</option>
                <option value="fr">French</option>
            </select>
        </label>
        <iframe id="mathFrame" src="/worksheet-generators/math%20worksheet.html?locale=en" width="100%" height="600"></iframe>
    </div>
    
    <script>
        async function testLocale(locale) {
            const url = `/worksheet-generators/math%20worksheet.html?locale=${locale}`;
            const response = await fetch(url);
            const html = await response.text();
            
            // Create a temporary div to parse HTML
            const div = document.createElement('div');
            div.innerHTML = html;
            
            // Check if translations are in the code
            const hasTranslations = html.includes('translations[locale]');
            const hasApplyFunction = html.includes('applyTranslations()');
            
            // Expected translations
            const expectedTranslations = {
                en: { worksheetSettings: 'Worksheet Settings', pageSetup: 'Page Setup' },
                de: { worksheetSettings: 'Arbeitsblatt-Einstellungen', pageSetup: 'Seiteneinrichtung' },
                fr: { worksheetSettings: 'Param√®tres de la feuille', pageSetup: 'Configuration de page' }
            };
            
            const results = document.getElementById('results');
            results.innerHTML = `
                <h3>Testing ${locale.toUpperCase()}</h3>
                <p class="${hasTranslations ? 'success' : 'error'}">
                    Has translation system: ${hasTranslations}
                </p>
                <p class="${hasApplyFunction ? 'success' : 'error'}">
                    Has apply function: ${hasApplyFunction}
                </p>
                <p>Expected translations:</p>
                <ul>
                    <li>worksheetSettings: ${expectedTranslations[locale].worksheetSettings}</li>
                    <li>pageSetup: ${expectedTranslations[locale].pageSetup}</li>
                </ul>
            `;
            
            // Test in iframe
            updateIframe(locale);
        }
        
        function updateIframe(locale) {
            document.getElementById('mathFrame').src = `/worksheet-generators/math%20worksheet.html?locale=${locale}`;
        }
        
        // Test English by default
        window.onload = () => testLocale('en');
    </script>
</body>
</html>