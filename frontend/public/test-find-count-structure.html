<!DOCTYPE html>
<html>
<head>
    <title>Test Find Count Structure</title>
</head>
<body>
    <h1>Test Find Count Structure</h1>

    <!-- SAME STRUCTURE AS find-and-count-v2.html -->
    <div class="accordion-content active">
        <h4>Background</h4>
        <label for="backgroundThemeSelect">Background Theme:</label>
        <select id="backgroundThemeSelect">
            <option value="none">None</option>
        </select>

        <h4>Border</h4>
        <label for="borderThemeSelect">Border Theme:</label>
        <select id="borderThemeSelect">
            <option value="none">None</option>
        </select>
    </div>

    <script>
        console.log('Script started');

        // Define functions OUTSIDE DOMContentLoaded like find-and-count-v2.html
        async function populateBorderThemes() {
            console.log('populateBorderThemes called');
            const borderThemeSelect = document.getElementById('borderThemeSelect');
            console.log('borderThemeSelect found:', !!borderThemeSelect);

            try {
                const response = await fetch('/api/borders/themes');
                const themes = await response.json();
                console.log('Border themes received:', themes);

                themes.forEach(theme => {
                    const option = document.createElement('option');
                    option.value = theme.value || theme;
                    option.textContent = theme.displayName || theme;
                    borderThemeSelect.appendChild(option);
                });

                console.log('Border select now has', borderThemeSelect.options.length, 'options');
            } catch (error) {
                console.error('Error:', error);
            }
        }

        async function populateBackgroundThemes() {
            console.log('populateBackgroundThemes called');
            const backgroundThemeSelect = document.getElementById('backgroundThemeSelect');
            console.log('backgroundThemeSelect found:', !!backgroundThemeSelect);

            try {
                const response = await fetch('/api/backgrounds/themes');
                const themes = await response.json();
                console.log('Background themes received:', themes);

                themes.forEach(theme => {
                    const option = document.createElement('option');
                    option.value = theme.value || theme;
                    option.textContent = theme.displayName || theme;
                    backgroundThemeSelect.appendChild(option);
                });

                console.log('Background select now has', backgroundThemeSelect.options.length, 'options');
            } catch (error) {
                console.error('Error:', error);
            }
        }

        // Call functions on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOMContentLoaded fired');
            populateBorderThemes();
            populateBackgroundThemes();
        });

        // ALSO try calling immediately for testing
        console.log('Calling functions immediately (before DOMContentLoaded)...');
        populateBorderThemes();
        populateBackgroundThemes();
    </script>
</body>
</html>