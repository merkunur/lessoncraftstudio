<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Find Objects Complete Translation Verification</title>
    <script src="frontend/public/worksheet-generators/js/translations-find-objects.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .language-section {
            margin: 30px 0;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 10px;
            background: #f9f9f9;
        }
        h2 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .test-item {
            padding: 10px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .key {
            font-family: monospace;
            font-size: 12px;
            color: #666;
        }
        .translation {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-top: 5px;
        }
        .pass { background-color: #d4edda; }
        .fail { background-color: #f8d7da; }
        .summary {
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
        }
        .summary.success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #28a745;
        }
        .summary.warning {
            background: #fff3cd;
            color: #856404;
            border: 2px solid #ffc107;
        }
        .summary.error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }
        .critical-section {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .critical-section h3 {
            color: #856404;
            margin-top: 0;
        }
    </style>
</head>
<body>
    <h1>üîç Find Objects Translation Verification - COMPLETE TEST</h1>
    <p><strong>Testing all 11 languages with focus on user-reported issues</strong></p>

    <div class="critical-section">
        <h3>üéØ Critical Items (User Reported as Still in English)</h3>
        <ul id="criticalItems">
            <li>Select a theme for backgrounds.</li>
            <li>Select a theme for borders.</li>
            <li>Color:</li>
            <li>Size:</li>
            <li>Font:</li>
            <li>Outline Color:</li>
            <li>Outline (0-10):</li>
            <li>Other Content</li>
            <li>Include Name/Date Fields</li>
            <li>All Themes</li>
            <li>Available Images</li>
            <li>Choose files</li>
            <li>No file chosen</li>
            <li>Your uploaded images will appear here.</li>
            <li>Or Select Theme for Distractors:</li>
            <li>Or Select Theme for Hidden Objects:</li>
            <li>No Theme (Use Manual Selection)</li>
        </ul>
    </div>

    <div id="testResults"></div>

    <script>
        // Critical keys that user reported as still in English
        const criticalKeys = [
            { key: 'findobjects.background.message', en: 'Select a theme for backgrounds.' },
            { key: 'findobjects.border.message', en: 'Select a theme to see borders.' },
            { key: 'findobjects.text.color.label', en: 'Color:' },
            { key: 'findobjects.text.size.label', en: 'Size:' },
            { key: 'findobjects.text.font.label', en: 'Font:' },
            { key: 'findobjects.text.outline.color.label', en: 'Outline Color:' },
            { key: 'findobjects.text.outline.width.label', en: 'Outline (0-10):' },
            { key: 'findobjects.other.content.label', en: 'Other Content' },
            { key: 'findobjects.include.name.date.label', en: 'Include Name/Date Fields' },
            { key: 'findobjects.all.themes', en: 'All Themes' },
            { key: 'findobjects.available.images.label', en: 'Available Images' },
            { key: 'findobjects.choose.files', en: 'Choose files' },
            { key: 'findobjects.no.file.chosen', en: 'No file chosen' },
            { key: 'findobjects.upload.placeholder', en: 'Your uploaded images will appear here.' },
            { key: 'findobjects.distractors.theme.label', en: 'Or Select Theme for Distractors:' },
            { key: 'findobjects.hidden.theme.label', en: 'Or Select Theme for Hidden Objects:' },
            { key: 'findobjects.no.theme.manual', en: '-- No Theme (Use Manual Selection) --' }
        ];

        // Additional important keys
        const additionalKeys = [
            { key: 'findobjects.background.title', en: 'Background' },
            { key: 'findobjects.border.title', en: 'Border' },
            { key: 'common.grayscale', en: 'Grayscale' },
            { key: 'findobjects.page.scene', en: 'Page & Scene' },
            { key: 'findobjects.text.content', en: 'Text & Content' },
            { key: 'findobjects.image.library', en: 'Image Library' },
            { key: 'findobjects.object.selection', en: 'Object Selection' },
            { key: 'findobjects.generate', en: 'Generate' },
            { key: 'findobjects.clear.all', en: 'Clear All' },
            { key: 'findobjects.tab.worksheet', en: 'Worksheet' },
            { key: 'findobjects.tab.answer', en: 'Answer Key' }
        ];

        const allTestKeys = [...criticalKeys, ...additionalKeys];

        const languages = {
            en: { name: 'English', flag: 'üá¨üáß' },
            de: { name: 'German', flag: 'üá©üá™' },
            fr: { name: 'French', flag: 'üá´üá∑' },
            es: { name: 'Spanish', flag: 'üá™üá∏' },
            it: { name: 'Italian', flag: 'üáÆüáπ' },
            pt: { name: 'Portuguese', flag: 'üáµüáπ' },
            nl: { name: 'Dutch', flag: 'üá≥üá±' },
            sv: { name: 'Swedish', flag: 'üá∏üá™' },
            da: { name: 'Danish', flag: 'üá©üá∞' },
            no: { name: 'Norwegian', flag: 'üá≥üá¥' },
            fi: { name: 'Finnish', flag: 'üá´üáÆ' }
        };

        const container = document.getElementById('testResults');
        let globalResults = {};

        // Test each language
        Object.entries(languages).forEach(([langCode, langInfo]) => {
            const section = document.createElement('div');
            section.className = 'language-section';

            // Set current locale for testing
            window.currentLocale = langCode;

            let passCount = 0;
            let failCount = 0;
            let criticalPass = 0;
            let criticalFail = 0;

            // Create test grid
            let gridHTML = '<div class="test-grid">';

            // Test critical keys first
            gridHTML += '<h3 style="grid-column: 1/-1;">üî¥ Critical Items (User Reported)</h3>';
            criticalKeys.forEach(test => {
                const result = t(test.key);
                const isTranslated = result !== test.key;
                const isCorrect = langCode === 'en' ? result === test.en : isTranslated && result !== test.en;

                if (isCorrect) {
                    criticalPass++;
                    passCount++;
                } else {
                    criticalFail++;
                    failCount++;
                }

                gridHTML += `
                    <div class="test-item ${isCorrect ? 'pass' : 'fail'}">
                        <div class="key">${test.key}</div>
                        <div class="translation">${result}</div>
                        <div style="color: ${isCorrect ? 'green' : 'red'}; margin-top: 5px;">
                            ${isCorrect ? '‚úÖ Translated' : '‚ùå Missing'}
                        </div>
                    </div>
                `;
            });

            // Test additional keys
            gridHTML += '<h3 style="grid-column: 1/-1;">‚ú® Additional Important Keys</h3>';
            additionalKeys.forEach(test => {
                const result = t(test.key);
                const isTranslated = result !== test.key;
                const isCorrect = langCode === 'en' ? result === test.en : isTranslated && result !== test.en;

                if (isCorrect) passCount++;
                else failCount++;

                gridHTML += `
                    <div class="test-item ${isCorrect ? 'pass' : 'fail'}">
                        <div class="key">${test.key}</div>
                        <div class="translation">${result}</div>
                    </div>
                `;
            });

            gridHTML += '</div>';

            // Calculate coverage
            const totalKeys = Object.keys(translations[langCode] || {}).length;
            const coverage = ((passCount / allTestKeys.length) * 100).toFixed(1);
            const criticalCoverage = ((criticalPass / criticalKeys.length) * 100).toFixed(1);

            // Determine status
            let summaryClass = 'success';
            if (criticalCoverage < 100) summaryClass = 'error';
            else if (coverage < 100) summaryClass = 'warning';

            // Create section HTML
            section.innerHTML = `
                <h2>${langInfo.flag} ${langInfo.name} (${langCode.toUpperCase()})</h2>
                <div class="summary ${summaryClass}">
                    Critical Coverage: ${criticalCoverage}% (${criticalPass}/${criticalKeys.length}) |
                    Overall Coverage: ${coverage}% (${passCount}/${allTestKeys.length}) |
                    Total Keys Available: ${totalKeys}
                </div>
                ${gridHTML}
            `;

            container.appendChild(section);

            // Store results
            globalResults[langCode] = {
                critical: criticalCoverage,
                overall: coverage,
                total: totalKeys
            };
        });

        // Overall summary
        const overallSummary = document.createElement('div');
        overallSummary.className = 'critical-section';
        overallSummary.style.marginTop = '40px';

        let summaryHTML = '<h2>üìä Overall Summary</h2>';
        summaryHTML += '<table style="width: 100%; border-collapse: collapse;">';
        summaryHTML += '<tr><th style="text-align: left;">Language</th><th>Critical Coverage</th><th>Overall Coverage</th><th>Total Keys</th></tr>';

        Object.entries(globalResults).forEach(([lang, results]) => {
            const criticalClass = results.critical === '100.0' ? 'pass' : 'fail';
            summaryHTML += `
                <tr>
                    <td>${languages[lang].flag} ${languages[lang].name}</td>
                    <td class="${criticalClass}" style="text-align: center; font-weight: bold;">${results.critical}%</td>
                    <td style="text-align: center;">${results.overall}%</td>
                    <td style="text-align: center;">${results.total}</td>
                </tr>
            `;
        });

        summaryHTML += '</table>';
        overallSummary.innerHTML = summaryHTML;
        document.body.appendChild(overallSummary);

        // Reset locale to English
        window.currentLocale = 'en';

        // Final message
        const finalMessage = document.createElement('div');
        finalMessage.style.marginTop = '20px';
        finalMessage.style.padding = '20px';
        finalMessage.style.background = '#e8f4f8';
        finalMessage.style.borderRadius = '8px';
        finalMessage.innerHTML = `
            <h3>üöÄ How to Test in the Actual App</h3>
            <ol>
                <li>Open: <code>find objects.html?locale=de</code> for German</li>
                <li>Open: <code>find objects.html?locale=fr</code> for French</li>
                <li>Open: <code>find objects.html?locale=sv</code> for Swedish</li>
                <li>Check that ALL text changes to the selected language</li>
                <li>Particularly verify the items listed as "Critical" above</li>
            </ol>
        `;
        document.body.appendChild(finalMessage);
    </script>
</body>
</html>