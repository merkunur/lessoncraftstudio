<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Big or Small App Console Test</title>
    <script type="module">
        import '/web-components/big-small-app/index.js';
        
        window.addEventListener('DOMContentLoaded', () => {
            console.log('=== BIG OR SMALL APP TEST ===');
            
            // Create the element
            const app = document.createElement('lcs-big-small-app');
            app.id = 'testApp';
            
            // Set attributes
            app.setAttribute('locale', 'en');
            app.setAttribute('subscription', 'premium');
            
            // Add to DOM
            document.getElementById('container').appendChild(app);
            console.log('1. App element added to DOM');
            
            // Check if element is registered
            console.log('2. Element registered:', customElements.get('lcs-big-small-app') !== undefined);
            
            // Wait for element to be ready
            setTimeout(() => {
                console.log('3. Checking shadow DOM...');
                console.log('   - Has shadowRoot:', app.shadowRoot !== null);
                
                if (app.shadowRoot) {
                    console.log('   - imageGrid exists:', app.shadowRoot.getElementById('imageGrid') !== null);
                    console.log('   - generateBtn exists:', app.shadowRoot.getElementById('generateBtn') !== null);
                    console.log('   - worksheetCanvas exists:', app.shadowRoot.getElementById('worksheetCanvas') !== null);
                }
                
                console.log('4. Checking methods...');
                console.log('   - updateImageLibrary:', typeof app.updateImageLibrary);
                console.log('   - getSampleImages:', typeof app.getSampleImages);
                console.log('   - _images length:', app._images ? app._images.length : 'undefined');
                
                // Try to call getSampleImages
                if (typeof app.getSampleImages === 'function') {
                    const samples = app.getSampleImages();
                    console.log('5. Sample images:', samples);
                }
                
                // Set test images
                const testImages = [
                    { id: 'cat', displayName: 'Cat', url: '/images/animals/cat.png' },
                    { id: 'dog', displayName: 'Dog', url: '/images/animals/dog.png' }
                ];
                
                console.log('6. Setting test images...');
                app.images = testImages;
                
                setTimeout(() => {
                    console.log('7. After setting images:');
                    console.log('   - _images:', app._images);
                    
                    // Check image grid
                    const imageGrid = app.shadowRoot.getElementById('imageGrid');
                    if (imageGrid) {
                        console.log('   - Image items in grid:', imageGrid.querySelectorAll('.image-item').length);
                        
                        // Try clicking first image
                        const firstItem = imageGrid.querySelector('.image-item');
                        if (firstItem) {
                            console.log('8. Clicking first image...');
                            firstItem.click();
                            console.log('   - Selected images:', app.selectedImages.size);
                        }
                    }
                    
                    // Try generate button
                    const generateBtn = app.shadowRoot.getElementById('generateBtn');
                    if (generateBtn) {
                        console.log('9. Generate button:');
                        console.log('   - Enabled:', !generateBtn.disabled);
                        console.log('   - Click handler attached:', generateBtn.onclick !== null || generateBtn._listeners);
                    }
                }, 500);
                
            }, 500);
        });
    </script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #f5f5f5;
        }
        #container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 20px;
            min-height: 600px;
        }
        h1 {
            color: #333;
        }
    </style>
</head>
<body>
    <h1>Big or Small App Console Test</h1>
    <p>Check browser console for detailed output</p>
    <div id="container"></div>
</body>
</html>