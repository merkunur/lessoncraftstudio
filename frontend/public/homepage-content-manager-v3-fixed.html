<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homepage Content Manager v3 - Fixed</title>
    <!-- Sortable.js for drag-and-drop -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: #333;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 16px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            background: white;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 24px;
            background: #f5f5f5;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .tab:hover:not(.active) {
            background: #e0e0e0;
        }

        .content-section {
            display: none;
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            animation: fadeIn 0.3s;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 500;
            font-size: 14px;
        }

        input[type="text"],
        input[type="url"],
        textarea,
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: transform 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-danger {
            background: #dc3545;
        }

        .btn-success {
            background: #28a745;
        }

        .btn-small {
            padding: 5px 10px;
            font-size: 12px;
        }

        .btn-primary {
            background: #007bff;
        }

        .card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid #e9ecef;
        }

        .card h3, .card h4 {
            margin-bottom: 15px;
            color: #333;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        @media (max-width: 768px) {
            .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }
        }

        .actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .feature-item,
        .pricing-item,
        .sample-item {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .feature-item h4,
        .pricing-item h4,
        .sample-item h4 {
            margin-bottom: 10px;
        }

        .item-actions {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .message {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .message.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .upload-zone {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-zone:hover,
        .upload-zone.drag-over {
            border-color: #667eea;
            background: #f0f3ff;
        }

        .image-preview {
            max-width: 200px;
            max-height: 150px;
            object-fit: contain;
        }

        .image-preview-container {
            position: relative;
            display: inline-block;
        }

        .image-remove {
            position: absolute;
            top: -10px;
            right: -10px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            font-size: 16px;
            line-height: 1;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-header h2 {
            color: #333;
        }

        .footer-section-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .footer-link-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .footer-link-item input {
            flex: 1;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            animation: fadeIn 0.3s;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .footer-section-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .footer-link-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .modal-content {
            background: white;
            border-radius: 10px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h3 {
            color: #333;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .modal-close:hover {
            color: #333;
        }

        .modal-body {
            margin-bottom: 20px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .feature-list-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }

        .feature-list-item input {
            flex: 1;
        }

        .feature-list-item button {
            padding: 5px 10px;
        }

        .drag-handle {
            cursor: move;
            color: #999;
            margin-right: 10px;
        }

        .sortable-ghost {
            opacity: 0.5;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .icon-selector {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .icon-option {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .icon-option:hover,
        .icon-option.selected {
            border-color: #667eea;
            background: #f0f3ff;
        }

        /* Language tabs */
        .lang-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .lang-tab {
            padding: 8px 16px;
            background: #f5f5f5;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }

        .lang-tab.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .lang-tab:hover:not(.active) {
            background: #e0e0e0;
        }

        .lang-content {
            display: none;
        }

        .lang-content.active {
            display: block;
        }

        /* Grid layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        /* Sample cards */
        .sample-card {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.3s;
        }

        .sample-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }

        .sample-image-container {
            height: 150px;
            background: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sample-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
        }

        .sample-content {
            padding: 15px;
        }

        .sample-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .sample-description {
            font-size: 13px;
            color: #666;
            margin-bottom: 10px;
        }

        .sample-meta {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }

        .badge {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }

        .badge-blue { background: #e3f2ff; color: #1976d2; }
        .badge-green { background: #e8f5e9; color: #388e3c; }
        .badge-purple { background: #f3e5f5; color: #7b1fa2; }
        .badge-yellow { background: #fff8e1; color: #f57c00; }
        .badge-red { background: #ffebee; color: #c62828; }

        /* Loading and messages */
        #loadingOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        #loadingOverlay.show {
            display: flex;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 10000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s;
        }

        .message.show {
            opacity: 1;
            transform: translateX(0);
        }

        .message.success {
            background: #4caf50;
        }

        .message.error {
            background: #f44336;
        }

        .message.info {
            background: #2196f3;
        }

        /* Drag and Drop Styles */
        .sample-card {
            position: relative;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .sample-card .drag-handle {
            position: absolute;
            top: 10px;
            left: 10px;
            cursor: move;
            background: rgba(255,255,255,0.9);
            border-radius: 4px;
            padding: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            z-index: 10;
            font-size: 18px;
            line-height: 1;
            color: #667eea;
            user-select: none;
        }

        .sample-card .drag-handle:hover {
            background: #667eea;
            color: white;
        }

        .sample-card.sortable-ghost {
            opacity: 0.4;
            background: #f0f3ff;
        }

        .sample-card.sortable-drag {
            opacity: 0.8;
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
            transform: rotate(2deg);
        }

        #samples-list.sortable-dragging .sample-card:not(.sortable-drag) {
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üé® Homepage Content Manager v3 - Fixed</h1>
            <p>Complete control over all homepage content with working edit functionality</p>
            <div id="message-container"></div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('navigation')">Navigation</button>
            <button class="tab" onclick="switchTab('hero')">Hero Section</button>
            <button class="tab" onclick="switchTab('features')">Features</button>
            <button class="tab" onclick="switchTab('apps')">Apps</button>
            <button class="tab" onclick="switchTab('samples')">Samples</button>
            <button class="tab" onclick="switchTab('pricing')">Pricing</button>
            <button class="tab" onclick="switchTab('footer')">Footer</button>
            <button class="tab" onclick="switchTab('translations')">Translations</button>
            <button class="tab" onclick="switchTab('seo')">SEO</button>
        </div>

        <!-- Content Sections (placeholder for now) -->
        <div id="content-sections">
            <!-- Will be populated by JavaScript -->
        </div>

        <!-- Save Actions -->
        <div class="actions" style="margin-top: 30px;">
            <button class="btn btn-success" onclick="saveAllContent()">üíæ Save All Changes</button>
            <button class="btn btn-secondary" onclick="loadContent()">üîÑ Reload Content</button>
        </div>
    </div>

    <!-- Feature Edit Modal -->
    <div id="feature-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Feature</h3>
                <button class="modal-close" onclick="closeFeatureModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Icon</label>
                    <select id="feature-icon">
                        <option value="apps">Apps</option>
                        <option value="images">Images</option>
                        <option value="languages">Languages</option>
                        <option value="pod">POD License</option>
                        <option value="license">License</option>
                        <option value="education">Education</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Color Scheme</label>
                    <select id="feature-color">
                        <option value="primary">Primary</option>
                        <option value="secondary">Secondary</option>
                        <option value="accent">Accent</option>
                        <option value="green">Green</option>
                    </select>
                </div>
                <div id="feature-translations"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeFeatureModal()">Cancel</button>
                <button class="btn btn-success" onclick="saveFeature()">Save Feature</button>
            </div>
        </div>
    </div>

    <!-- Pricing Edit Modal -->
    <div id="pricing-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Pricing Tier</h3>
                <button class="modal-close" onclick="closePricingModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Price</label>
                    <input type="text" id="pricing-price" placeholder="$0">
                </div>
                <div class="form-group">
                    <label>Price Period</label>
                    <input type="text" id="pricing-period" placeholder="/mo or leave empty">
                </div>
                <div class="form-group">
                    <label>Highlighted</label>
                    <input type="checkbox" id="pricing-highlighted">
                </div>
                <div id="pricing-translations"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closePricingModal()">Cancel</button>
                <button class="btn btn-success" onclick="savePricing()">Save Pricing</button>
            </div>
        </div>
    </div>

    <!-- App Edit Modal -->
    <div id="app-modal" class="modal">
        <div class="modal-content" style="max-width: 1000px;">
            <div class="modal-header">
                <h3>Edit App</h3>
                <button class="modal-close" onclick="closeAppModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="grid-2">
                    <div class="form-group">
                        <label>Icon (Emoji)</label>
                        <input type="text" id="app-icon" placeholder="‚ûï" maxlength="2">
                    </div>
                    <div class="form-group">
                        <label>URL</label>
                        <input type="text" id="app-url" placeholder="/worksheet-generators/app.html">
                    </div>
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label>Category</label>
                        <select id="app-category">
                            <option value="Math">Math</option>
                            <option value="Language">Language</option>
                            <option value="Logic">Logic</option>
                            <option value="Art">Art</option>
                            <option value="Visual">Visual</option>
                            <option value="Game">Game</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tier</label>
                        <select id="app-tier">
                            <option value="free">Free</option>
                            <option value="core">Core</option>
                            <option value="full">Full</option>
                        </select>
                    </div>
                </div>
                <div id="app-translations"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeAppModal()">Cancel</button>
                <button class="btn btn-success" onclick="saveApp()">Save App</button>
            </div>
        </div>
    </div>

    <script>
        let homepageContent = {};
        let currentFeatureIndex = -1;
        let currentPricingIndex = -1;
        let currentAppIndex = -1;
        const languages = ['en', 'de', 'fr', 'es', 'it', 'pt', 'nl', 'sv', 'da', 'no', 'fi'];
        const languageNames = {
            en: 'English',
            de: 'German',
            fr: 'French',
            es: 'Spanish',
            it: 'Italian',
            pt: 'Portuguese',
            nl: 'Dutch',
            sv: 'Swedish',
            da: 'Danish',
            no: 'Norwegian',
            fi: 'Finnish'
        };

        // Default apps data from dashboard with all translations
        function getDefaultAppsData() {
            return {
                appsSection: {
                    title: {
                        en: 'Our Apps', de: 'Unsere Apps', fr: 'Nos applications', es: 'Nuestras aplicaciones',
                        it: 'Le nostre app', pt: 'Nossos aplicativos', nl: 'Onze apps', sv: 'V√•ra appar',
                        da: 'Vores apps', no: 'V√•re apper', fi: 'Sovelluksemme'
                    },
                    subtitle: {
                        en: 'Explore our collection of worksheet generators', de: 'Erkunden Sie unsere Sammlung von Arbeitsblatt-Generatoren',
                        fr: 'Explorez notre collection de g√©n√©rateurs de feuilles de travail', es: 'Explora nuestra colecci√≥n de generadores de hojas de trabajo',
                        it: 'Esplora la nostra collezione di generatori di fogli di lavoro', pt: 'Explore nossa cole√ß√£o de geradores de planilhas',
                        nl: 'Verken onze collectie werkbladgeneratoren', sv: 'Utforska v√•r samling av arbetsbladsgeneratorer',
                        da: 'Udforsk vores samling af regnearksgeneratorer', no: 'Utforsk v√•r samling av regnearkgeneratorer',
                        fi: 'Tutustu ty√∂arkkien luontiohjelmien kokoelmaamme'
                    },
                    categories: {
                        Math: { en: 'Math', de: 'Mathematik', fr: 'Math√©matiques', es: 'Matem√°ticas', it: 'Matematica', pt: 'Matem√°tica', nl: 'Wiskunde', sv: 'Matematik', da: 'Matematik', no: 'Matematikk', fi: 'Matematiikka' },
                        Language: { en: 'Language', de: 'Sprache', fr: 'Langue', es: 'Idioma', it: 'Lingua', pt: 'Idioma', nl: 'Taal', sv: 'Spr√•k', da: 'Sprog', no: 'Spr√•k', fi: 'Kieli' },
                        Logic: { en: 'Logic', de: 'Logik', fr: 'Logique', es: 'L√≥gica', it: 'Logica', pt: 'L√≥gica', nl: 'Logica', sv: 'Logik', da: 'Logik', no: 'Logikk', fi: 'Logiikka' },
                        Art: { en: 'Art', de: 'Kunst', fr: 'Art', es: 'Arte', it: 'Arte', pt: 'Arte', nl: 'Kunst', sv: 'Konst', da: 'Kunst', no: 'Kunst', fi: 'Taide' },
                        Visual: { en: 'Visual', de: 'Visuell', fr: 'Visuel', es: 'Visual', it: 'Visivo', pt: 'Visual', nl: 'Visueel', sv: 'Visuell', da: 'Visuel', no: 'Visuell', fi: 'Visuaalinen' },
                        Game: { en: 'Game', de: 'Spiel', fr: 'Jeu', es: 'Juego', it: 'Gioco', pt: 'Jogo', nl: 'Spel', sv: 'Spel', da: 'Spil', no: 'Spill', fi: 'Peli' }
                    },
                    tierNames: {
                        free: { en: 'Free', de: 'Kostenlos', fr: 'Gratuit', es: 'Gratis', it: 'Gratis', pt: 'Gr√°tis', nl: 'Gratis', sv: 'Gratis', da: 'Gratis', no: 'Gratis', fi: 'Ilmainen' },
                        core: { en: 'Core', de: 'Kern', fr: 'Noyau', es: 'N√∫cleo', it: 'Nucleo', pt: 'N√∫cleo', nl: 'Kern', sv: 'K√§rna', da: 'Kerne', no: 'Kjerne', fi: 'Ydin' },
                        full: { en: 'Pro', de: 'Pro', fr: 'Pro', es: 'Pro', it: 'Pro', pt: 'Pro', nl: 'Pro', sv: 'Pro', da: 'Pro', no: 'Pro', fi: 'Pro' }
                    }
                },
                apps: [
                    // Free tier
                    {
                        name: { en: 'Word Search', de: 'Wortsuche', fr: 'Recherche de mots', es: 'Sopa de letras', it: 'Ricerca di parole', pt: 'Ca√ßa-palavras', nl: 'Woordzoeker', sv: 'Ordletare', da: 'Ords√∏gning', no: 'Ords√∏k', fi: 'Sanaristikko' },
                        description: { en: 'Create engaging word search puzzles', de: 'Erstellen Sie ansprechende Wortsuchr√§tsel', fr: 'Cr√©ez des grilles de mots m√™l√©s attrayantes', es: 'Crea sopas de letras atractivas', it: 'Crea puzzle di ricerca di parole coinvolgenti', pt: 'Crie ca√ßa-palavras envolventes', nl: 'Maak boeiende woordzoekopdrachten', sv: 'Skapa engagerande ordletare', da: 'Opret engagerende ords√∏gninger', no: 'Lag engasjerende ords√∏k', fi: 'Luo mukaansatempaavia sanaristikkoja' },
                        url: '/worksheet-generators/wordsearch.html', icon: 'üîç', tier: 'free', category: 'Language'
                    },
                    // Core tier
                    {
                        name: { en: 'Addition', de: 'Addition', fr: 'Addition', es: 'Suma', it: 'Addizione', pt: 'Adi√ß√£o', nl: 'Optellen', sv: 'Yhteenlasku', da: 'Addition', no: 'Addisjon', fi: 'Yhteenlasku' },
                        description: { en: 'Practice addition problems', de: '√úben Sie Additionsaufgaben', fr: 'Pratiquez les probl√®mes d addition', es: 'Practica problemas de suma', it: 'Esercitati con i problemi di addizione', pt: 'Pratique problemas de adi√ß√£o', nl: 'Oefen optellingen', sv: '√ñva additionsproblem', da: '√òv additionsopgaver', no: '√òv p√• addisjon', fi: 'Harjoittele yhteenlaskuja' },
                        url: '/worksheet-generators/addition.html', icon: '‚ûï', tier: 'core', category: 'Math'
                    },
                    {
                        name: { en: 'Subtraction', de: 'Subtraktion', fr: 'Soustraction', es: 'Resta', it: 'Sottrazione', pt: 'Subtra√ß√£o', nl: 'Aftrekken', sv: 'Subtraktion', da: 'Subtraktion', no: 'Subtraksjon', fi: 'V√§hennyslasku' },
                        description: { en: 'Master subtraction skills', de: 'Meistern Sie Subtraktionsf√§higkeiten', fr: 'Ma√Ætrisez les comp√©tences de soustraction', es: 'Domina las habilidades de resta', it: 'Padroneggia le abilit√† di sottrazione', pt: 'Domine habilidades de subtra√ß√£o', nl: 'Beheers aftrektechnieken', sv: 'Bem√§stra subtraktionsf√§rdigheter', da: 'Mestre subtraktionsf√¶rdigheder', no: 'Mestre subtraksjonsferdigheter', fi: 'Hallitse v√§hennyslaskutaidot' },
                        url: '/worksheet-generators/subtraction.html', icon: '‚ûñ', tier: 'core', category: 'Math'
                    },
                    {
                        name: { en: 'Alphabet Train', de: 'Alphabet-Zug', fr: 'Train de l alphabet', es: 'Tren del alfabeto', it: 'Treno dell alfabeto', pt: 'Trem do alfabeto', nl: 'Alfabettrein', sv: 'Alfabetst√•', da: 'Alfabettog', no: 'Alfabettog', fi: 'Aakkos juna' },
                        description: { en: 'Learn letters with train cars', de: 'Lernen Sie Buchstaben mit Zugwagen', fr: 'Apprenez les lettres avec des wagons', es: 'Aprende letras con vagones de tren', it: 'Impara le lettere con i vagoni del treno', pt: 'Aprenda letras com vag√µes de trem', nl: 'Leer letters met treinwagons', sv: 'L√§r dig bokst√§ver med t√•gvagnar', da: 'L√¶r bogstaver med togvogne', no: 'L√¶r bokstaver med togvogner', fi: 'Opi kirjaimia junalla' },
                        url: '/worksheet-generators/alphabet-train.html', icon: 'üöÇ', tier: 'core', category: 'Language'
                    },
                    {
                        name: { en: 'Find and Count', de: 'Finden und Z√§hlen', fr: 'Trouver et compter', es: 'Buscar y contar', it: 'Trova e conta', pt: 'Encontrar e contar', nl: 'Zoeken en tellen', sv: 'Hitta och r√§kna', da: 'Find og t√¶l', no: 'Finn og tell', fi: 'Etsi ja laske' },
                        description: { en: 'Count objects in pictures', de: 'Z√§hlen Sie Objekte in Bildern', fr: 'Comptez les objets dans les images', es: 'Cuenta objetos en im√°genes', it: 'Conta gli oggetti nelle immagini', pt: 'Conte objetos em imagens', nl: 'Tel objecten in afbeeldingen', sv: 'R√§kna objekt i bilder', da: 'T√¶l objekter i billeder', no: 'Tell objekter i bilder', fi: 'Laske esineit√§ kuvissa' },
                        url: '/worksheet-generators/find-and-count.html', icon: 'üî¢', tier: 'core', category: 'Math'
                    },
                    {
                        name: { en: 'Matching', de: 'Zuordnung', fr: 'Correspondance', es: 'Coincidencia', it: 'Abbinamento', pt: 'Correspond√™ncia', nl: 'Matchen', sv: 'Matchning', da: 'Matchning', no: 'Matching', fi: 'Yhteensopivuus' },
                        description: { en: 'Match related items', de: 'Ordnen Sie verwandte Elemente zu', fr: 'Associez des √©l√©ments li√©s', es: 'Empareja elementos relacionados', it: 'Abbina elementi correlati', pt: 'Combine itens relacionados', nl: 'Koppel gerelateerde items', sv: 'Matcha relaterade objekt', da: 'Match relaterede elementer', no: 'Match relaterte elementer', fi: 'Yhdist√§ toisiinsa liittyv√§t kohteet' },
                        url: '/worksheet-generators/matching.html', icon: 'üîó', tier: 'core', category: 'Logic'
                    },
                    {
                        name: { en: 'Crossword', de: 'Kreuzwortr√§tsel', fr: 'Mots crois√©s', es: 'Crucigrama', it: 'Cruciverba', pt: 'Palavras cruzadas', nl: 'Kruiswoordpuzzel', sv: 'Korsord', da: 'Krydsord', no: 'Kryssord', fi: 'Ristisanateht√§v√§' },
                        description: { en: 'Create custom crossword puzzles', de: 'Erstellen Sie benutzerdefinierte Kreuzwortr√§tsel', fr: 'Cr√©ez des mots crois√©s personnalis√©s', es: 'Crea crucigramas personalizados', it: 'Crea cruciverba personalizzati', pt: 'Crie palavras cruzadas personalizadas', nl: 'Maak aangepaste kruiswoordpuzzels', sv: 'Skapa anpassade korsord', da: 'Opret tilpassede krydsord', no: 'Lag tilpassede kryssord', fi: 'Luo mukautettuja ristisanateht√§vi√§' },
                        url: '/worksheet-generators/crossword.html', icon: '‚úñÔ∏è', tier: 'core', category: 'Language'
                    },
                    {
                        name: { en: 'Sudoku', de: 'Sudoku', fr: 'Sudoku', es: 'Sudoku', it: 'Sudoku', pt: 'Sudoku', nl: 'Sudoku', sv: 'Sudoku', da: 'Sudoku', no: 'Sudoku', fi: 'Sudoku' },
                        description: { en: 'Generate Sudoku puzzles', de: 'Erstellen Sie Sudoku-R√§tsel', fr: 'G√©n√©rez des grilles de Sudoku', es: 'Genera rompecabezas de Sudoku', it: 'Genera puzzle Sudoku', pt: 'Gere quebra-cabe√ßas de Sudoku', nl: 'Genereer Sudoku-puzzels', sv: 'Generera Sudoku-pussel', da: 'Generer Sudoku-opgaver', no: 'Generer Sudoku-oppgaver', fi: 'Luo Sudoku-teht√§vi√§' },
                        url: '/worksheet-generators/sudoku.html', icon: 'üî≥', tier: 'core', category: 'Logic'
                    },
                    {
                        name: { en: 'Coloring', de: 'Ausmalen', fr: 'Coloriage', es: 'Colorear', it: 'Colorare', pt: 'Colorir', nl: 'Kleuren', sv: 'F√§rgl√§ggning', da: 'Farvning', no: 'Farging', fi: 'V√§ritt√§minen' },
                        description: { en: 'Create coloring pages', de: 'Erstellen Sie Ausmalbilder', fr: 'Cr√©ez des pages de coloriage', es: 'Crea p√°ginas para colorear', it: 'Crea pagine da colorare', pt: 'Crie p√°ginas para colorir', nl: 'Maak kleurplaten', sv: 'Skapa f√§rgl√§ggningssidor', da: 'Opret farvel√¶gningssider', no: 'Lag fargeleggingssider', fi: 'Luo v√§rityskuvia' },
                        url: '/worksheet-generators/coloring.html', icon: 'üé®', tier: 'core', category: 'Art'
                    },
                    {
                        name: { en: 'Math Worksheet', de: 'Mathe-Arbeitsblatt', fr: 'Feuille de math√©matiques', es: 'Hoja de matem√°ticas', it: 'Foglio di matematica', pt: 'Folha de matem√°tica', nl: 'Wiskundig werkblad', sv: 'Mattarbetsblad', da: 'Matematikark', no: 'Matematikkark', fi: 'Matematiikan teht√§v√§lehti' },
                        description: { en: 'Generate practice math sheets', de: 'Erstellen Sie √úbungsbl√§tter f√ºr Mathematik', fr: 'G√©n√©rez des feuilles de pratique math√©matique', es: 'Genera hojas de pr√°ctica de matem√°ticas', it: 'Genera fogli di esercizi di matematica', pt: 'Gere folhas de pr√°tica matem√°tica', nl: 'Genereer wiskundeoefenbladen', sv: 'Generera √∂vningsblad i matematik', da: 'Generer matematik√∏velsesark', no: 'Generer matematikk√∏velsesark', fi: 'Luo harjoitusmatikkateht√§vi√§' },
                        url: '/worksheet-generators/math-worksheet.html', icon: 'üìê', tier: 'core', category: 'Math'
                    },
                    // Full tier (23 apps)
                    {
                        name: { en: 'Math Puzzle', de: 'Mathe-R√§tsel', fr: 'Puzzle math√©matique', es: 'Rompecabezas matem√°tico', it: 'Puzzle matematico', pt: 'Quebra-cabe√ßa matem√°tico', nl: 'Wiskundepuzzel', sv: 'Mattepussel', da: 'Matematikpuslespil', no: 'Mattepuslespill', fi: 'Matematiikkapalapeli' },
                        description: { en: 'Solve mathematical puzzles', de: 'L√∂sen Sie mathematische R√§tsel', fr: 'R√©solvez des √©nigmes math√©matiques', es: 'Resuelve acertijos matem√°ticos', it: 'Risolvi enigmi matematici', pt: 'Resolva quebra-cabe√ßas matem√°ticos', nl: 'Los wiskundige puzzels op', sv: 'L√∂s matematiska pussel', da: 'L√∏s matematiske g√•der', no: 'L√∏s matematiske g√•ter', fi: 'Ratkaise matemaattisia pulmia' },
                        url: '/worksheet-generators/math-puzzle.html', icon: 'üß©', tier: 'full', category: 'Math'
                    },
                    {
                        name: { en: 'Word Scramble', de: 'Buchstabensalat', fr: 'Mots m√©lang√©s', es: 'Palabras revueltas', it: 'Parole scramble', pt: 'Palavras embaralhadas', nl: 'Woordmix', sv: 'Ordmix', da: 'Ordmiks', no: 'Ordmiks', fi: 'Sanapulmapeli' },
                        description: { en: 'Unscramble mixed-up words', de: 'Entschl√ºsseln Sie gemischte W√∂rter', fr: 'D√©m√™lez les mots m√©lang√©s', es: 'Desenreda palabras mezcladas', it: 'Scomponi parole mescolate', pt: 'Desarranje palavras misturadas', nl: 'Ontwar gemengde woorden', sv: 'Reda ut blandade ord', da: 'Udred blandede ord', no: 'Red ut blandede ord', fi: 'Selvit√§ sekoitetut sanat' },
                        url: '/worksheet-generators/word-scramble.html', icon: 'üî§', tier: 'full', category: 'Language'
                    },
                    {
                        name: { en: 'Chart Count', de: 'Diagrammz√§hlung', fr: 'Comptage de graphiques', es: 'Conteo de gr√°ficos', it: 'Conteggio grafico', pt: 'Contagem de gr√°ficos', nl: 'Grafiek tellen', sv: 'Diagramr√§kning', da: 'Diagramt√¶lling', no: 'Diagramtelling', fi: 'Kaavion laskenta' },
                        description: { en: 'Practice reading charts', de: '√úben Sie das Lesen von Diagrammen', fr: 'Pratiquez la lecture de graphiques', es: 'Practica la lectura de gr√°ficos', it: 'Esercitati nella lettura di grafici', pt: 'Pratique a leitura de gr√°ficos', nl: 'Oefen het lezen van grafieken', sv: '√ñva att l√§sa diagram', da: '√òv at l√¶se diagrammer', no: '√òv p√• √• lese diagrammer', fi: 'Harjoittele kaavioiden lukemista' },
                        url: '/worksheet-generators/chart-count.html', icon: 'üìä', tier: 'full', category: 'Math'
                    },
                    {
                        name: { en: 'Drawing Lines', de: 'Linien zeichnen', fr: 'Tracer des lignes', es: 'Dibujar l√≠neas', it: 'Disegnare linee', pt: 'Desenhar linhas', nl: 'Lijnen tekenen', sv: 'Rita linjer', da: 'Tegn linjer', no: 'Tegn linjer', fi: 'Piirr√§ viivoja' },
                        description: { en: 'Practice line drawing', de: '√úben Sie das Zeichnen von Linien', fr: 'Pratiquez le trac√© de lignes', es: 'Practica el dibujo de l√≠neas', it: 'Esercitati nel disegno di linee', pt: 'Pratique o desenho de linhas', nl: 'Oefen het tekenen van lijnen', sv: '√ñva linjeteckning', da: '√òv linetegning', no: '√òv p√• linjetegning', fi: 'Harjoittele viivojen piirt√§mist√§' },
                        url: '/worksheet-generators/drawing-lines.html', icon: '‚úèÔ∏è', tier: 'full', category: 'Art'
                    },
                    {
                        name: { en: 'Big Small', de: 'Gro√ü Klein', fr: 'Grand Petit', es: 'Grande Peque√±o', it: 'Grande Piccolo', pt: 'Grande Pequeno', nl: 'Groot Klein', sv: 'Stor Liten', da: 'Stor Lille', no: 'Stor Liten', fi: 'Iso Pieni' },
                        description: { en: 'Compare sizes', de: 'Vergleichen Sie Gr√∂√üen', fr: 'Comparez les tailles', es: 'Compara tama√±os', it: 'Confronta le dimensioni', pt: 'Compare tamanhos', nl: 'Vergelijk maten', sv: 'J√§mf√∂r storlekar', da: 'Sammenlign st√∏rrelser', no: 'Sammenlign st√∏rrelser', fi: 'Vertaile kokoja' },
                        url: '/worksheet-generators/big-small.html', icon: '‚öñÔ∏è', tier: 'full', category: 'Visual'
                    },
                    {
                        name: { en: 'Code Addition', de: 'Code-Addition', fr: 'Addition cod√©e', es: 'Suma codificada', it: 'Addizione codificata', pt: 'Adi√ß√£o codificada', nl: 'Code-optelling', sv: 'Kodad addition', da: 'Kodeaddition', no: 'Kodeaddisjon', fi: 'Koodattu yhteenlasku' },
                        description: { en: 'Solve coded math problems', de: 'L√∂sen Sie codierte Matheaufgaben', fr: 'R√©solvez des probl√®mes math√©matiques cod√©s', es: 'Resuelve problemas matem√°ticos codificados', it: 'Risolvi problemi matematici codificati', pt: 'Resolva problemas matem√°ticos codificados', nl: 'Los gecodeerde wiskundeproblemen op', sv: 'L√∂s kodade matteproblem', da: 'L√∏s kodede matematikopgaver', no: 'L√∏s kodede matteproblemer', fi: 'Ratkaise koodattuja matemaattisia ongelmia' },
                        url: '/worksheet-generators/code-addition.html', icon: 'üîê', tier: 'full', category: 'Math'
                    },
                    {
                        name: { en: 'Cryptogram', de: 'Kryptogramm', fr: 'Cryptogramme', es: 'Criptograma', it: 'Crittogramma', pt: 'Criptograma', nl: 'Cryptogram', sv: 'Kryptogram', da: 'Kryptogram', no: 'Kryptogram', fi: 'Kryptogrammi' },
                        description: { en: 'Decode secret messages', de: 'Entschl√ºsseln Sie geheime Nachrichten', fr: 'D√©codez des messages secrets', es: 'Decodifica mensajes secretos', it: 'Decodifica messaggi segreti', pt: 'Decodifique mensagens secretas', nl: 'Decodeer geheime berichten', sv: 'Avkoda hemliga meddelanden', da: 'Afkod hemmelige beskeder', no: 'Dekod hemmelige meldinger', fi: 'Pura salattuja viestej√§' },
                        url: '/worksheet-generators/cryptogram.html', icon: 'üîì', tier: 'full', category: 'Logic'
                    },
                    {
                        name: { en: 'Draw and Color', de: 'Zeichnen und Ausmalen', fr: 'Dessiner et colorier', es: 'Dibujar y colorear', it: 'Disegna e colora', pt: 'Desenhar e colorir', nl: 'Tekenen en kleuren', sv: 'Rita och f√§rgl√§gg', da: 'Tegn og farv', no: 'Tegn og farg', fi: 'Piirr√§ ja v√§rit√§' },
                        description: { en: 'Creative drawing activities', de: 'Kreative Zeichenaktivit√§ten', fr: 'Activit√©s de dessin cr√©atif', es: 'Actividades de dibujo creativo', it: 'Attivit√† di disegno creativo', pt: 'Atividades de desenho criativo', nl: 'Creatieve tekenactiviteiten', sv: 'Kreativa ritaktiviteter', da: 'Kreative tegneaktiviteter', no: 'Kreative tegneaktiviteter', fi: 'Luovia piirustustoimintoja' },
                        url: '/worksheet-generators/draw-and-color.html', icon: 'üñçÔ∏è', tier: 'full', category: 'Art'
                    },
                    {
                        name: { en: 'Find Objects', de: 'Objekte finden', fr: 'Trouver des objets', es: 'Encontrar objetos', it: 'Trova oggetti', pt: 'Encontrar objetos', nl: 'Objecten vinden', sv: 'Hitta objekt', da: 'Find objekter', no: 'Finn objekter', fi: 'Etsi esineit√§' },
                        description: { en: 'Spot hidden objects', de: 'Entdecken Sie versteckte Objekte', fr: 'Rep√©rez les objets cach√©s', es: 'Encuentra objetos ocultos', it: 'Trova oggetti nascosti', pt: 'Encontre objetos escondidos', nl: 'Vind verborgen objecten', sv: 'Hitta dolda objekt', da: 'Find skjulte objekter', no: 'Finn skjulte objekter', fi: 'L√∂yd√§ piilotettuja esineit√§' },
                        url: '/worksheet-generators/find-objects.html', icon: 'üîé', tier: 'full', category: 'Visual'
                    },
                    {
                        name: { en: 'Grid Match', de: 'Raster-Match', fr: 'Correspondance de grille', es: 'Coincidencia de cuadr√≠cula', it: 'Corrispondenza griglia', pt: 'Correspond√™ncia de grade', nl: 'Rastermatch', sv: 'Rutn√§tsmatchning', da: 'Gittermatch', no: 'Rutenettmatch', fi: 'Ruudukkovastaavuus' },
                        description: { en: 'Match items on a grid', de: 'Ordnen Sie Elemente in einem Raster zu', fr: 'Faites correspondre des √©l√©ments sur une grille', es: 'Empareja elementos en una cuadr√≠cula', it: 'Abbina elementi su una griglia', pt: 'Combine itens em uma grade', nl: 'Koppel items in een raster', sv: 'Matcha objekt i ett rutn√§t', da: 'Match elementer p√• et gitter', no: 'Match elementer p√• et rutenett', fi: 'Yhdist√§ kohteet ruudukossa' },
                        url: '/worksheet-generators/grid-match.html', icon: '‚¨ú', tier: 'full', category: 'Logic'
                    },
                    {
                        name: { en: 'More Less', de: 'Mehr Weniger', fr: 'Plus Moins', es: 'M√°s Menos', it: 'Pi√π Meno', pt: 'Mais Menos', nl: 'Meer Minder', sv: 'Mer Mindre', da: 'Mere Mindre', no: 'Mer Mindre', fi: 'Enemm√§n V√§hemm√§n' },
                        description: { en: 'Compare quantities', de: 'Vergleichen Sie Mengen', fr: 'Comparez les quantit√©s', es: 'Compara cantidades', it: 'Confronta le quantit√†', pt: 'Compare quantidades', nl: 'Vergelijk hoeveelheden', sv: 'J√§mf√∂r kvantiteter', da: 'Sammenlign m√¶ngder', no: 'Sammenlign mengder', fi: 'Vertaile m√§√§ri√§' },
                        url: '/worksheet-generators/more-less.html', icon: 'üî¢', tier: 'full', category: 'Math'
                    },
                    {
                        name: { en: 'Odd One Out', de: 'Odd One Out', fr: 'Intrus', es: 'El diferente', it: 'Il diverso', pt: 'O diferente', nl: 'Vreemde eend', sv: 'Udda en ut', da: 'Ulige en ud', no: 'Odd en ut', fi: 'Erottuja' },
                        description: { en: 'Find the different item', de: 'Finden Sie das unterschiedliche Element', fr: 'Trouvez l √©l√©ment diff√©rent', es: 'Encuentra el elemento diferente', it: 'Trova l elemento diverso', pt: 'Encontre o item diferente', nl: 'Vind het andere item', sv: 'Hitta det olika objektet', da: 'Find det forskellige element', no: 'Finn det forskjellige elementet', fi: 'L√∂yd√§ erilainen kohde' },
                        url: '/worksheet-generators/odd-one-out.html', icon: '‚ùì', tier: 'full', category: 'Logic'
                    },
                    {
                        name: { en: 'Picture Path', de: 'Bildpfad', fr: 'Chemin d images', es: 'Camino de im√°genes', it: 'Percorso immagini', pt: 'Caminho de imagens', nl: 'Afbeeldingspad', sv: 'Bildv√§g', da: 'Billedsti', no: 'Bildesti', fi: 'Kuvapolku' },
                        description: { en: 'Follow picture paths', de: 'Folgen Sie Bildpfaden', fr: 'Suivez les chemins d images', es: 'Sigue caminos de im√°genes', it: 'Segui percorsi di immagini', pt: 'Siga caminhos de imagens', nl: 'Volg afbeeldingspaden', sv: 'F√∂lj bildv√§gar', da: 'F√∏lg billedstier', no: 'F√∏lg bildestier', fi: 'Seuraa kuvapolkuja' },
                        url: '/worksheet-generators/picture-path.html', icon: 'üõ§Ô∏è', tier: 'full', category: 'Visual'
                    },
                    {
                        name: { en: 'Picture Sort', de: 'Bildsortierung', fr: 'Tri d images', es: 'Ordenar im√°genes', it: 'Ordinamento immagini', pt: 'Classifica√ß√£o de imagens', nl: 'Afbeeldingen sorteren', sv: 'Bildsortering', da: 'Billedsortering', no: 'Bildesortering', fi: 'Kuvien lajittelu' },
                        description: { en: 'Sort and categorize pictures', de: 'Sortieren und kategorisieren Sie Bilder', fr: 'Triez et cat√©gorisez les images', es: 'Ordena y categoriza im√°genes', it: 'Ordina e categorizza le immagini', pt: 'Classifique e categorize imagens', nl: 'Sorteer en categoriseer afbeeldingen', sv: 'Sortera och kategorisera bilder', da: 'Sorter og kategoriser billeder', no: 'Sorter og kategoriser bilder', fi: 'Lajittele ja luokittele kuvia' },
                        url: '/worksheet-generators/picture-sort.html', icon: 'üñºÔ∏è', tier: 'full', category: 'Logic'
                    },
                    {
                        name: { en: 'Prepositions', de: 'Pr√§positionen', fr: 'Pr√©positions', es: 'Preposiciones', it: 'Preposizioni', pt: 'Preposi√ß√µes', nl: 'Voorzetsels', sv: 'Prepositioner', da: 'Pr√¶positioner', no: 'Preposisjoner', fi: 'Prepositiot' },
                        description: { en: 'Learn positional words', de: 'Lernen Sie Positionsw√∂rter', fr: 'Apprenez les mots de position', es: 'Aprende palabras de posici√≥n', it: 'Impara le parole di posizione', pt: 'Aprenda palavras de posi√ß√£o', nl: 'Leer positiewoorden', sv: 'L√§r dig positionsord', da: 'L√¶r positionsord', no: 'L√¶r posisjonsord', fi: 'Opi paikkasanoja' },
                        url: '/worksheet-generators/prepositions.html', icon: 'üìç', tier: 'full', category: 'Language'
                    },
                    {
                        name: { en: 'Treasure Hunt', de: 'Schatzsuche', fr: 'Chasse au tr√©sor', es: 'B√∫squeda del tesoro', it: 'Caccia al tesoro', pt: 'Ca√ßa ao tesouro', nl: 'Schattenjacht', sv: 'Skattjakt', da: 'Skattejagt', no: 'Skattejakt', fi: 'Aarteenetsint√§' },
                        description: { en: 'Follow clues to find treasure', de: 'Folgen Sie Hinweisen, um Sch√§tze zu finden', fr: 'Suivez les indices pour trouver le tr√©sor', es: 'Sigue pistas para encontrar tesoro', it: 'Segui gli indizi per trovare il tesoro', pt: 'Siga pistas para encontrar tesouro', nl: 'Volg aanwijzingen om schat te vinden', sv: 'F√∂lj ledtr√•dar f√∂r att hitta skatten', da: 'F√∏lg spor for at finde skat', no: 'F√∏lg ledetr√•der for √• finne skatten', fi: 'Seuraa vihjeit√§ l√∂yt√§√§ksesi aarteen' },
                        url: '/worksheet-generators/treasure-hunt.html', icon: 'üè¥‚Äç‚ò†Ô∏è', tier: 'full', category: 'Game'
                    },
                    {
                        name: { en: 'Word Guess', de: 'Wort-Raten', fr: 'Deviner le mot', es: 'Adivinar palabra', it: 'Indovina la parola', pt: 'Adivinhar palavra', nl: 'Woord raden', sv: 'Gissa ordet', da: 'G√¶t ordet', no: 'Gjett ordet', fi: 'Arvaa sana' },
                        description: { en: 'Guess words from clues', de: 'Erraten Sie W√∂rter aus Hinweisen', fr: 'Devinez des mots √† partir d indices', es: 'Adivina palabras a partir de pistas', it: 'Indovina parole dagli indizi', pt: 'Adivinhe palavras a partir de pistas', nl: 'Raad woorden uit hints', sv: 'Gissa ord fr√•n ledtr√•dar', da: 'G√¶t ord fra spor', no: 'Gjett ord fra ledetr√•der', fi: 'Arvaa sanat vihjeist√§' },
                        url: '/worksheet-generators/word-guess.html', icon: 'üí≠', tier: 'full', category: 'Language'
                    },
                    {
                        name: { en: 'Writing', de: 'Schreiben', fr: '√âcriture', es: 'Escritura', it: 'Scrittura', pt: 'Escrita', nl: 'Schrijven', sv: 'Skrivning', da: 'Skrivning', no: 'Skriving', fi: 'Kirjoitus' },
                        description: { en: 'Practice handwriting', de: '√úben Sie Handschrift', fr: 'Pratiquez l √©criture manuscrite', es: 'Practica la escritura a mano', it: 'Esercitati nella scrittura a mano', pt: 'Pratique a escrita √† m√£o', nl: 'Oefen handschrift', sv: '√ñva handstil', da: '√òv h√•ndskrift', no: '√òv h√•ndskrift', fi: 'Harjoittele k√§sinkirjoitusta' },
                        url: '/worksheet-generators/writing.html', icon: '‚úçÔ∏è', tier: 'full', category: 'Language'
                    },
                    {
                        name: { en: 'Bingo', de: 'Bingo', fr: 'Bingo', es: 'Bingo', it: 'Bingo', pt: 'Bingo', nl: 'Bingo', sv: 'Bingo', da: 'Bingo', no: 'Bingo', fi: 'Bingo' },
                        description: { en: 'Create custom bingo cards', de: 'Erstellen Sie benutzerdefinierte Bingokarten', fr: 'Cr√©ez des cartes de bingo personnalis√©es', es: 'Crea tarjetas de bingo personalizadas', it: 'Crea cartelle bingo personalizzate', pt: 'Crie cart√µes de bingo personalizados', nl: 'Maak aangepaste bingokaarten', sv: 'Skapa anpassade bingokort', da: 'Opret tilpassede bingokort', no: 'Lag tilpassede bingokort', fi: 'Luo mukautettuja bingokorteja' },
                        url: '/worksheet-generators/bingo.html', icon: 'üé≤', tier: 'full', category: 'Game'
                    },
                    {
                        name: { en: 'Shadow Match', de: 'Schatten-Match', fr: 'Correspondance d ombres', es: 'Coincidencia de sombras', it: 'Corrispondenza ombre', pt: 'Correspond√™ncia de sombras', nl: 'Schaduwmatch', sv: 'Skuggmatchning', da: 'Skyggematch', no: 'Skyggematch', fi: 'Varjon vastaavuus' },
                        description: { en: 'Match objects with shadows', de: 'Ordnen Sie Objekte mit Schatten zu', fr: 'Associez des objets avec des ombres', es: 'Empareja objetos con sombras', it: 'Abbina oggetti con ombre', pt: 'Combine objetos com sombras', nl: 'Koppel objecten aan schaduwen', sv: 'Matcha objekt med skuggor', da: 'Match objekter med skygger', no: 'Match objekter med skygger', fi: 'Yhdist√§ esineet varjoihin' },
                        url: '/worksheet-generators/shadow-match.html', icon: 'üë§', tier: 'full', category: 'Visual'
                    },
                    {
                        name: { en: 'Pattern Train', de: 'Muster-Zug', fr: 'Train de motifs', es: 'Tren de patrones', it: 'Treno di modelli', pt: 'Trem de padr√µes', nl: 'Patroontrein', sv: 'M√∂nstart√•g', da: 'M√∏nsterttog', no: 'M√∏nstertog', fi: 'Kuviojuna' },
                        description: { en: 'Complete pattern sequences', de: 'Vervollst√§ndigen Sie Musterfolgen', fr: 'Compl√©tez des s√©quences de motifs', es: 'Completa secuencias de patrones', it: 'Completa sequenze di modelli', pt: 'Complete sequ√™ncias de padr√µes', nl: 'Voltooi patroonreeksen', sv: 'Slutf√∂r m√∂nstersekvenser', da: 'Fuldf√∏r m√∏nstersekvenser', no: 'Fullf√∏r m√∏nstersekvenser', fi: 'T√§ydenn√§ kuviojonoja' },
                        url: '/worksheet-generators/pattern-train.html', icon: 'üöÉ', tier: 'full', category: 'Logic'
                    },
                    {
                        name: { en: 'Pattern Worksheet', de: 'Muster-Arbeitsblatt', fr: 'Feuille de motifs', es: 'Hoja de patrones', it: 'Foglio di modelli', pt: 'Folha de padr√µes', nl: 'Patroonwerkblad', sv: 'M√∂nsterarbetsblad', da: 'M√∏nsterark', no: 'M√∏nsterark', fi: 'Kuvioteht√§v√§lehti' },
                        description: { en: 'Practice pattern recognition', de: '√úben Sie Mustererkennung', fr: 'Pratiquez la reconnaissance de motifs', es: 'Practica el reconocimiento de patrones', it: 'Esercitati nel riconoscimento dei modelli', pt: 'Pratique o reconhecimento de padr√µes', nl: 'Oefen patroonherkenning', sv: '√ñva m√∂nsterigenk√§nning', da: '√òv m√∏nstergenkendelse', no: '√òv p√• m√∏nstergjenkjenning', fi: 'Harjoittele kuvioiden tunnistamista' },
                        url: '/worksheet-generators/pattern-worksheet.html', icon: 'üî≤', tier: 'full', category: 'Logic'
                    },
                    {
                        name: { en: 'Missing Pieces', de: 'Fehlende Teile', fr: 'Pi√®ces manquantes', es: 'Piezas faltantes', it: 'Pezzi mancanti', pt: 'Pe√ßas faltantes', nl: 'Ontbrekende stukken', sv: 'Saknade bitar', da: 'Manglende dele', no: 'Manglende deler', fi: 'Puuttuvat palaset' },
                        description: { en: 'Find missing puzzle pieces', de: 'Finden Sie fehlende Puzzleteile', fr: 'Trouvez les pi√®ces de puzzle manquantes', es: 'Encuentra piezas de rompecabezas faltantes', it: 'Trova i pezzi mancanti del puzzle', pt: 'Encontre pe√ßas de quebra-cabe√ßa faltantes', nl: 'Vind ontbrekende puzzelstukken', sv: 'Hitta saknade pusselbitar', da: 'Find manglende puslespilsbrikker', no: 'Finn manglende puslespillbiter', fi: 'L√∂yd√§ puuttuvat palapelinpalat' },
                        url: '/worksheet-generators/missing-pieces.html', icon: 'üß©', tier: 'full', category: 'Logic'
                    }
                ]
            };
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            loadContent();
        });

        async function loadContent() {
            showLoading(true);
            try {
                const response = await fetch('/api/homepage/content?raw=true');
                if (response.ok) {
                    homepageContent = await response.json();

                    // Initialize apps data with defaults if not present
                    if (!homepageContent.apps || homepageContent.apps.length === 0) {
                        const defaultData = getDefaultAppsData();
                        homepageContent.apps = defaultData.apps;
                        homepageContent.appsSection = defaultData.appsSection;
                        console.log('Initialized default apps data');
                    }

                    console.log('=== Homepage Content Loaded ===');
                    console.log('Has hero?', homepageContent.hero ? 'YES' : 'NO');
                    console.log('Has samplesSection?', homepageContent.samplesSection ? 'YES' : 'NO');
                    console.log('Has apps?', homepageContent.apps ? `YES (${homepageContent.apps.length})` : 'NO');
                    console.log('Hero title.en:', homepageContent.hero?.title?.en);
                    console.log('Full hero:', homepageContent.hero);
                    renderAllSections();
                    showMessage('Content loaded successfully', 'success');
                } else {
                    showMessage('Failed to load content', 'error');
                }
            } catch (error) {
                console.error('Error loading content:', error);
                showMessage('Error loading content', 'error');
            } finally {
                showLoading(false);
            }
        }

        function renderAllSections() {
            const container = document.getElementById('content-sections');
            container.innerHTML = `
                <!-- Navigation Section -->
                <div id="navigation-section" class="content-section active">
                    <div class="section-header">
                        <h2>Navigation</h2>
                    </div>
                    <div id="navigation-content">
                        <div class="card">
                            <h3>Logo</h3>
                            <div class="form-group">
                                <label>Logo Text</label>
                                <input type="text" id="nav-logo-text" placeholder="LessonCraftStudio">
                            </div>
                            <div class="form-group">
                                <label>Logo Image</label>
                                <div id="logo-preview"></div>
                                <input type="file" id="logo-upload" accept="image/*" onchange="handleLogoUpload(event)">
                            </div>
                        </div>
                        <div class="card">
                            <h3>Menu Items</h3>
                            <div id="menu-items-container"></div>
                        </div>
                        <div class="card">
                            <h3>Navigation Buttons</h3>
                            <div id="nav-buttons-container"></div>
                        </div>
                    </div>
                </div>

                <!-- Hero Section -->
                <div id="hero-section" class="content-section">
                    <div class="section-header">
                        <h2>Hero Section</h2>
                    </div>
                    <div id="hero-content">
                        <div class="lang-tabs">
                            ${languages.map(lang => `<button class="lang-tab ${lang === 'en' ? 'active' : ''}" onclick="switchLanguage('hero', '${lang}')">${languageNames[lang]}</button>`).join('')}
                        </div>
                        ${languages.map(lang => `
                            <div id="hero-content-${lang}" class="lang-content ${lang === 'en' ? 'active' : ''}">
                                <div class="form-group">
                                    <label>Title</label>
                                    <input type="text" id="hero-title-${lang}" placeholder="Main headline">
                                </div>
                                <div class="form-group">
                                    <label>Subtitle</label>
                                    <textarea id="hero-subtitle-${lang}" placeholder="Supporting text"></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Primary CTA Text</label>
                                    <input type="text" id="hero-cta-primary-${lang}" placeholder="Try Free">
                                </div>
                                <div class="form-group">
                                    <label>Secondary CTA Text</label>
                                    <input type="text" id="hero-cta-secondary-${lang}" placeholder="Learn More">
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- Features Section -->
                <div id="features-section" class="content-section">
                    <div class="section-header">
                        <h2>Features</h2>
                        <button class="btn btn-small btn-primary" onclick="addFeature()">+ Add Feature</button>
                    </div>
                    <div id="features-content">
                        <div class="card">
                            <h3>Section Headers</h3>
                            <div class="grid-2">
                                ${languages.map(lang => `
                                    <div class="form-group">
                                        <label>${languageNames[lang]} - Title</label>
                                        <input type="text" id="features-title-${lang}" placeholder="Section title">
                                    </div>
                                `).join('')}
                            </div>
                            <div class="grid-2">
                                ${languages.map(lang => `
                                    <div class="form-group">
                                        <label>${languageNames[lang]} - Subtitle</label>
                                        <input type="text" id="features-subtitle-${lang}" placeholder="Section subtitle">
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <h3>Feature Items</h3>
                        <div class="features-list" id="features-list"></div>
                    </div>
                </div>

                <!-- Apps Section -->
                <div id="apps-section" class="content-section">
                    <div class="section-header">
                        <h2>Apps</h2>
                        <button class="btn btn-small btn-primary" onclick="addApp()">+ Add App</button>
                    </div>
                    <div id="apps-content">
                        <div class="card">
                            <h3>Section Headers</h3>
                            <div class="grid-2">
                                ${languages.map(lang => `
                                    <div class="form-group">
                                        <label>${languageNames[lang]} - Title</label>
                                        <input type="text" id="apps-title-${lang}" placeholder="Apps section title">
                                    </div>
                                `).join('')}
                            </div>
                            <div class="grid-2">
                                ${languages.map(lang => `
                                    <div class="form-group">
                                        <label>${languageNames[lang]} - Subtitle</label>
                                        <input type="text" id="apps-subtitle-${lang}" placeholder="Apps section subtitle">
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="card">
                            <h3>Categories</h3>
                            ${['Math', 'Language', 'Logic', 'Art', 'Visual', 'Game'].map(cat => `
                                <div style="margin-bottom: 20px;">
                                    <h4 style="color: #667eea; margin-bottom: 10px;">${cat}</h4>
                                    <div class="grid-3">
                                        ${languages.map(lang => `
                                            <div class="form-group">
                                                <label>${languageNames[lang]}</label>
                                                <input type="text" id="app-category-${cat}-${lang}" placeholder="Translation for ${cat}">
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>

                        <div class="card">
                            <h3>Tier Names</h3>
                            ${['free', 'core', 'full'].map(tier => `
                                <div style="margin-bottom: 20px;">
                                    <h4 style="color: #667eea; margin-bottom: 10px;">${tier.charAt(0).toUpperCase() + tier.slice(1)}</h4>
                                    <div class="grid-3">
                                        ${languages.map(lang => `
                                            <div class="form-group">
                                                <label>${languageNames[lang]}</label>
                                                <input type="text" id="app-tier-${tier}-${lang}" placeholder="Translation for ${tier}">
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>

                        <h3>App Items</h3>
                        <div class="apps-list" id="apps-list"></div>
                    </div>
                </div>

                <!-- Samples Section -->
                <div id="samples-section" class="content-section">
                    <div class="section-header">
                        <h2>Worksheet Samples</h2>
                        <button class="btn btn-small btn-primary" onclick="openSampleModal()">+ Add Sample</button>
                    </div>
                    <div id="samples-content">
                        <div class="card">
                            <h3>Section Headers</h3>
                            <div class="grid-2">
                                ${languages.map(lang => `
                                    <div class="form-group">
                                        <label>${languageNames[lang]} - Title</label>
                                        <input type="text" id="samples-title-${lang}" placeholder="Gallery title">
                                    </div>
                                `).join('')}
                            </div>
                            <div class="grid-2">
                                ${languages.map(lang => `
                                    <div class="form-group">
                                        <label>${languageNames[lang]} - Subtitle</label>
                                        <textarea id="samples-subtitle-${lang}" placeholder="Gallery description"></textarea>
                                    </div>
                                `).join('')}
                            </div>
                            <div class="grid-2">
                                ${languages.map(lang => `
                                    <div class="form-group">
                                        <label>${languageNames[lang]} - CTA Text</label>
                                        <input type="text" id="samples-cta-${lang}" placeholder="View all apps">
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="card">
                            <h3>Categories</h3>
                            ${['math', 'literacy', 'puzzle', 'logic', 'creative'].map(cat => `
                                <div style="margin-bottom: 20px;">
                                    <h4 style="color: #667eea; margin-bottom: 10px;">${cat.charAt(0).toUpperCase() + cat.slice(1)}</h4>
                                    <div class="grid-3">
                                        ${languages.map(lang => `
                                            <div class="form-group">
                                                <label>${languageNames[lang]}</label>
                                                <input type="text" id="category-${cat}-${lang}" placeholder="Translation for ${cat}">
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>

                        <div class="card">
                            <h3>Difficulties</h3>
                            ${['easy', 'medium', 'hard'].map(diff => `
                                <div style="margin-bottom: 20px;">
                                    <h4 style="color: #667eea; margin-bottom: 10px;">${diff.charAt(0).toUpperCase() + diff.slice(1)}</h4>
                                    <div class="grid-3">
                                        ${languages.map(lang => `
                                            <div class="form-group">
                                                <label>${languageNames[lang]}</label>
                                                <input type="text" id="difficulty-${diff}-${lang}" placeholder="Translation for ${diff}">
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>

                        <div class="card">
                            <h3>Modal Labels</h3>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #667eea; margin-bottom: 10px;">Age Range Label</h4>
                                <div class="grid-3">
                                    ${languages.map(lang => `
                                        <div class="form-group">
                                            <label>${languageNames[lang]}</label>
                                            <input type="text" id="modal-age-range-${lang}" placeholder="e.g. Age Range">
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #667eea; margin-bottom: 10px;">Difficulty Label</h4>
                                <div class="grid-3">
                                    ${languages.map(lang => `
                                        <div class="form-group">
                                            <label>${languageNames[lang]}</label>
                                            <input type="text" id="modal-difficulty-${lang}" placeholder="e.g. Difficulty">
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #667eea; margin-bottom: 10px;">Category Label</h4>
                                <div class="grid-3">
                                    ${languages.map(lang => `
                                        <div class="form-group">
                                            <label>${languageNames[lang]}</label>
                                            <input type="text" id="modal-category-${lang}" placeholder="e.g. Category">
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>

                        <h3>Sample Worksheets</h3>
                        <div id="samples-list" class="grid-3"></div>
                    </div>
                </div>

                <!-- Pricing Section -->
                <div id="pricing-section" class="content-section">
                    <div class="section-header">
                        <h2>Pricing</h2>
                        <button class="btn btn-small btn-primary" onclick="addPricingTier()">+ Add Pricing Tier</button>
                    </div>
                    <div id="pricing-content">
                        <div class="card">
                            <h3>Section Headers</h3>
                            <div class="grid-2">
                                ${languages.map(lang => `
                                    <div class="form-group">
                                        <label>${languageNames[lang]} - Title</label>
                                        <input type="text" id="pricing-title-${lang}" placeholder="Pricing title">
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <h3>Pricing Tiers</h3>
                        <div class="pricing-list" id="pricing-list"></div>
                    </div>
                </div>

                <!-- Footer Section -->
                <div id="footer-section" class="content-section">
                    <div class="section-header">
                        <h2>Footer</h2>
                    </div>
                    <div id="footer-content"></div>
                </div>

                <!-- Translations Section -->
                <div id="translations-section" class="content-section">
                    <div class="section-header">
                        <h2>Common Translations</h2>
                    </div>
                    <div id="translations-content">
                        <div class="card">
                            <div class="grid-2">
                                ${['loading', 'error', 'success', 'no-results', 'view-more', 'view-less', 'search', 'filter'].map(field => `
                                    <div>
                                        <h4>${field.replace('-', ' ').split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ')}</h4>
                                        ${languages.slice(0, 3).map(lang => `
                                            <div class="form-group">
                                                <label>${languageNames[lang]}</label>
                                                <input type="text" id="ui-${field}-${lang}" placeholder="Translation">
                                            </div>
                                        `).join('')}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SEO Section -->
                <div id="seo-section" class="content-section">
                    <div class="section-header">
                        <h2>SEO Settings</h2>
                    </div>
                    <div id="seo-content">
                        <div class="lang-tabs">
                            ${languages.map(lang => `<button class="lang-tab ${lang === 'en' ? 'active' : ''}" onclick="switchLanguage('seo', '${lang}')">${languageNames[lang]}</button>`).join('')}
                        </div>
                        ${languages.map(lang => `
                            <div id="seo-content-${lang}" class="lang-content ${lang === 'en' ? 'active' : ''}">
                                <div class="form-group">
                                    <label>Page Title</label>
                                    <input type="text" id="seo-title-${lang}" placeholder="SEO title">
                                </div>
                                <div class="form-group">
                                    <label>Meta Description</label>
                                    <textarea id="seo-description-${lang}" rows="3" placeholder="SEO description"></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Keywords</label>
                                    <textarea id="seo-keywords-${lang}" rows="2" placeholder="Comma-separated keywords"></textarea>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            // Render each section
            renderNavigationSection();
            renderHeroSection();
            renderFeaturesSection();
            renderAppsSection();
            renderSamplesSection();
            renderPricingSection();
            renderFooterSection();
            renderTranslationsSection();
            renderSEOSection();
        }

        function renderFeaturesSection() {
            const container = document.getElementById('features-content');
            if (!homepageContent.features) return;

            let html = '<div class="features-list">';
            homepageContent.features.forEach((feature, index) => {
                html += `
                    <div class="feature-item">
                        <div class="item-header">
                            <h4>${feature.title?.en || 'Feature ' + (index + 1)}</h4>
                            <div class="item-actions">
                                <button class="btn btn-small btn-primary" onclick="editFeature(${index})">Edit</button>
                                <button class="btn btn-small btn-danger" onclick="deleteFeature(${index})">Delete</button>
                            </div>
                        </div>
                        <p>${feature.description?.en || 'No description'}</p>
                        <small>Icon: ${feature.icon || 'none'} | Color: ${feature.color_scheme || 'primary'}</small>
                    </div>
                `;
            });
            html += '</div>';
            container.innerHTML = html;
        }

        function renderPricingSection() {
            const container = document.getElementById('pricing-content');
            if (!homepageContent.pricing) return;

            let html = '<div class="pricing-list">';
            homepageContent.pricing.forEach((tier, index) => {
                html += `
                    <div class="pricing-item">
                        <div class="item-header">
                            <h4>${tier.name?.en || 'Tier ' + (index + 1)}</h4>
                            <div class="item-actions">
                                <button class="btn btn-small btn-primary" onclick="editPricing(${index})">Edit</button>
                                <button class="btn btn-small btn-danger" onclick="deletePricing(${index})">Delete</button>
                            </div>
                        </div>
                        <p>Price: ${tier.price || '$0'} ${tier.price_period || ''}</p>
                        <p>Features: ${tier.features?.en?.length || 0} items</p>
                    </div>
                `;
            });
            html += '</div>';
            container.innerHTML = html;
        }

        function renderAppsSection() {
            // Update section headers
            if (homepageContent.appsSection) {
                languages.forEach(lang => {
                    const titleEl = document.getElementById(`apps-title-${lang}`);
                    const subtitleEl = document.getElementById(`apps-subtitle-${lang}`);

                    if (titleEl) titleEl.value = homepageContent.appsSection.title?.[lang] || '';
                    if (subtitleEl) subtitleEl.value = homepageContent.appsSection.subtitle?.[lang] || '';
                });
            }

            // Update categories
            if (homepageContent.appsSection?.categories) {
                ['Math', 'Language', 'Logic', 'Art', 'Visual', 'Game'].forEach(cat => {
                    languages.forEach(lang => {
                        const catEl = document.getElementById(`app-category-${cat}-${lang}`);
                        if (catEl) catEl.value = homepageContent.appsSection.categories[cat]?.[lang] || '';
                    });
                });
            }

            // Update tier names
            if (homepageContent.appsSection?.tierNames) {
                ['free', 'core', 'full'].forEach(tier => {
                    languages.forEach(lang => {
                        const tierEl = document.getElementById(`app-tier-${tier}-${lang}`);
                        if (tierEl) tierEl.value = homepageContent.appsSection.tierNames[tier]?.[lang] || '';
                    });
                });
            }

            // Render apps list
            const appsList = document.getElementById('apps-list');
            if (appsList && homepageContent.apps) {
                appsList.innerHTML = '';
                homepageContent.apps.forEach((app, index) => {
                    const appItem = document.createElement('div');
                    appItem.className = 'feature-item';
                    appItem.innerHTML = `
                        <div class="item-header">
                            <h4>${app.icon || 'üìù'} ${app.name?.en || 'App ' + (index + 1)}</h4>
                            <div class="item-actions">
                                <button class="btn btn-small btn-primary" onclick="editApp(${index})">Edit</button>
                                <button class="btn btn-small btn-danger" onclick="deleteApp(${index})">Delete</button>
                            </div>
                        </div>
                        <p>${app.description?.en || 'No description'}</p>
                        <small>Category: ${app.category || 'None'} | Tier: ${app.tier || 'core'} | URL: ${app.url || 'N/A'}</small>
                    `;
                    appsList.appendChild(appItem);
                });
            }
        }

        function renderFooterSection() {
            const container = document.getElementById('footer-content');
            if (!homepageContent.footer) return;

            let html = `
                <div class="card">
                    <h3>Company Info</h3>
                    <div class="grid-2">
                        ${languages.map(lang => `
                            <div class="form-group">
                                <label>${languageNames[lang]} - Company Name</label>
                                <input type="text" id="footer-company-${lang}"
                                       value="${homepageContent.footer.companyName?.[lang] || ''}"
                                       onchange="updateFooterField('companyName', '${lang}', this.value)">
                            </div>
                        `).join('')}
                    </div>
                    <div class="grid-2">
                        ${languages.map(lang => `
                            <div class="form-group">
                                <label>${languageNames[lang]} - Tagline</label>
                                <textarea id="footer-tagline-${lang}"
                                          onchange="updateFooterField('companyTagline', '${lang}', this.value)">${homepageContent.footer.companyTagline?.[lang] || ''}</textarea>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="card">
                    <h3>Footer Sections</h3>
                    ${renderFooterSections()}
                </div>

                <div class="card">
                    <h3>Copyright Text</h3>
                    <div class="grid-2">
                        ${languages.map(lang => `
                            <div class="form-group">
                                <label>${languageNames[lang]}</label>
                                <input type="text" id="footer-copyright-${lang}"
                                       value="${homepageContent.footer.copyright?.[lang] || ''}"
                                       onchange="updateFooterField('copyright', '${lang}', this.value)">
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            container.innerHTML = html;
        }

        function renderFooterSections() {
            const sections = homepageContent.footer?.sections || {};
            let html = '';

            ['product', 'support', 'legal'].forEach(sectionKey => {
                const section = sections[sectionKey];
                if (!section) return;

                html += `
                    <div class="footer-section-item" style="margin-bottom: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                        <h4 style="color: #667eea; margin-bottom: 15px;">${sectionKey.charAt(0).toUpperCase() + sectionKey.slice(1)} Section</h4>

                        <div class="form-group">
                            <h5>Section Title (All Languages)</h5>
                            <div class="grid-3">
                                ${languages.map(lang => `
                                    <div class="form-group">
                                        <label>${languageNames[lang]}</label>
                                        <input type="text" id="footer-${sectionKey}-title-${lang}"
                                               placeholder="${languageNames[lang]} title"
                                               value="${section.title?.[lang] || ''}"
                                               onchange="updateFooterSectionTitle('${sectionKey}', '${lang}', this.value)">
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="form-group">
                            <h5>Links</h5>
                            ${Object.entries(section.links || {}).map(([linkKey, linkValue]) => `
                                <div style="margin-bottom: 20px; padding: 15px; background: white; border-radius: 6px;">
                                    <h6 style="color: #764ba2; margin-bottom: 10px;">${linkKey.charAt(0).toUpperCase() + linkKey.slice(1)}</h6>
                                    <div class="grid-3">
                                        ${languages.map(lang => `
                                            <div class="form-group">
                                                <label>${languageNames[lang]}</label>
                                                <input type="text" id="footer-${sectionKey}-${linkKey}-${lang}"
                                                       placeholder="${languageNames[lang]}"
                                                       value="${linkValue[lang] || ''}"
                                                       onchange="updateFooterSectionLink('${sectionKey}', '${linkKey}', '${lang}', this.value)">
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });

            return html;
        }

        // Feature Modal Functions
        function editFeature(index) {
            currentFeatureIndex = index;
            const feature = homepageContent.features[index];

            document.getElementById('feature-icon').value = feature.icon || 'apps';
            document.getElementById('feature-color').value = feature.color_scheme || 'primary';

            const translationsDiv = document.getElementById('feature-translations');
            translationsDiv.innerHTML = `
                <h4>Title Translations</h4>
                <div class="grid-2">
                    ${languages.map(lang => `
                        <div class="form-group">
                            <label>${languageNames[lang]}</label>
                            <input type="text" id="feature-title-${lang}"
                                   value="${feature.title?.[lang] || ''}"
                                   placeholder="Feature title">
                        </div>
                    `).join('')}
                </div>

                <h4>Description Translations</h4>
                <div class="grid-2">
                    ${languages.map(lang => `
                        <div class="form-group">
                            <label>${languageNames[lang]}</label>
                            <textarea id="feature-desc-${lang}"
                                      placeholder="Feature description">${feature.description?.[lang] || ''}</textarea>
                        </div>
                    `).join('')}
                </div>
            `;

            document.getElementById('feature-modal').classList.add('active');
        }

        function saveFeature() {
            if (currentFeatureIndex === -1) return;

            const feature = homepageContent.features[currentFeatureIndex];
            feature.icon = document.getElementById('feature-icon').value;
            feature.color_scheme = document.getElementById('feature-color').value;

            if (!feature.title) feature.title = {};
            if (!feature.description) feature.description = {};

            languages.forEach(lang => {
                feature.title[lang] = document.getElementById(`feature-title-${lang}`).value;
                feature.description[lang] = document.getElementById(`feature-desc-${lang}`).value;
            });

            renderFeaturesSection();
            closeFeatureModal();
            showMessage('Feature updated', 'success');
        }

        function closeFeatureModal() {
            document.getElementById('feature-modal').classList.remove('active');
            currentFeatureIndex = -1;
        }

        function addFeature() {
            const newFeature = {
                icon: 'apps',
                title: { en: 'New Feature' },
                description: { en: 'Feature description' },
                color_scheme: 'primary',
                sort_order: homepageContent.features.length + 1
            };
            homepageContent.features.push(newFeature);
            renderFeaturesSection();
            editFeature(homepageContent.features.length - 1);
        }

        function deleteFeature(index) {
            if (confirm('Delete this feature?')) {
                homepageContent.features.splice(index, 1);
                renderFeaturesSection();
                showMessage('Feature deleted', 'success');
            }
        }

        // Pricing Modal Functions
        function editPricing(index) {
            currentPricingIndex = index;
            const tier = homepageContent.pricing[index];

            document.getElementById('pricing-price').value = tier.price || '';
            document.getElementById('pricing-period').value = tier.price_period || '';
            document.getElementById('pricing-highlighted').checked = tier.highlighted || false;

            const translationsDiv = document.getElementById('pricing-translations');
            translationsDiv.innerHTML = `
                <h4>Name Translations</h4>
                <div class="grid-2">
                    ${languages.map(lang => `
                        <div class="form-group">
                            <label>${languageNames[lang]}</label>
                            <input type="text" id="pricing-name-${lang}"
                                   value="${tier.name?.[lang] || ''}"
                                   placeholder="Tier name">
                        </div>
                    `).join('')}
                </div>

                <h4>Features (one per line)</h4>
                <div class="grid-2">
                    ${languages.map(lang => `
                        <div class="form-group">
                            <label>${languageNames[lang]}</label>
                            <textarea id="pricing-features-${lang}"
                                      rows="5"
                                      placeholder="One feature per line">${(tier.features?.[lang] || []).join('\\n')}</textarea>
                        </div>
                    `).join('')}
                </div>

                <h4>CTA Button Text</h4>
                <div class="grid-2">
                    ${languages.map(lang => `
                        <div class="form-group">
                            <label>${languageNames[lang]}</label>
                            <input type="text" id="pricing-cta-${lang}"
                                   value="${tier.cta_text?.[lang] || ''}"
                                   placeholder="Button text">
                        </div>
                    `).join('')}
                </div>

                <h4>Badge Text (if highlighted)</h4>
                <div class="grid-2">
                    ${languages.map(lang => `
                        <div class="form-group">
                            <label>${languageNames[lang]}</label>
                            <input type="text" id="pricing-badge-${lang}"
                                   value="${tier.badge_text?.[lang] || ''}"
                                   placeholder="Badge text">
                        </div>
                    `).join('')}
                </div>
            `;

            document.getElementById('pricing-modal').classList.add('active');
        }

        function savePricing() {
            if (currentPricingIndex === -1) return;

            const tier = homepageContent.pricing[currentPricingIndex];
            tier.price = document.getElementById('pricing-price').value;
            tier.price_period = document.getElementById('pricing-period').value;
            tier.highlighted = document.getElementById('pricing-highlighted').checked;

            if (!tier.name) tier.name = {};
            if (!tier.features) tier.features = {};
            if (!tier.cta_text) tier.cta_text = {};
            if (!tier.badge_text) tier.badge_text = {};

            languages.forEach(lang => {
                tier.name[lang] = document.getElementById(`pricing-name-${lang}`).value;
                tier.features[lang] = document.getElementById(`pricing-features-${lang}`).value.split('\\n').filter(f => f.trim());
                tier.cta_text[lang] = document.getElementById(`pricing-cta-${lang}`).value;
                tier.badge_text[lang] = document.getElementById(`pricing-badge-${lang}`).value;
            });

            renderPricingSection();
            closePricingModal();
            showMessage('Pricing tier updated', 'success');
        }

        function closePricingModal() {
            document.getElementById('pricing-modal').classList.remove('active');
            currentPricingIndex = -1;
        }

        function addPricingTier() {
            const newTier = {
                name: { en: 'New Plan' },
                price: '$0',
                price_period: '/mo',
                features: { en: ['Feature 1', 'Feature 2'] },
                cta_text: { en: 'Get Started' },
                cta_link: '/signup',
                highlighted: false,
                badge_text: {},
                sort_order: homepageContent.pricing.length + 1
            };
            homepageContent.pricing.push(newTier);
            renderPricingSection();
            editPricing(homepageContent.pricing.length - 1);
        }

        function deletePricing(index) {
            if (confirm('Delete this pricing tier?')) {
                homepageContent.pricing.splice(index, 1);
                renderPricingSection();
                showMessage('Pricing tier deleted', 'success');
            }
        }

        // App Modal Functions
        function editApp(index) {
            currentAppIndex = index;
            const app = homepageContent.apps[index];

            document.getElementById('app-icon').value = app.icon || '';
            document.getElementById('app-url').value = app.url || '';
            document.getElementById('app-category').value = app.category || 'Math';
            document.getElementById('app-tier').value = app.tier || 'core';

            const translationsDiv = document.getElementById('app-translations');
            translationsDiv.innerHTML = `
                <h4>Name Translations</h4>
                <div class="grid-2">
                    ${languages.map(lang => `
                        <div class="form-group">
                            <label>${languageNames[lang]}</label>
                            <input type="text" id="app-name-${lang}"
                                   value="${app.name?.[lang] || ''}"
                                   placeholder="App name">
                        </div>
                    `).join('')}
                </div>

                <h4>Description Translations</h4>
                <div class="grid-2">
                    ${languages.map(lang => `
                        <div class="form-group">
                            <label>${languageNames[lang]}</label>
                            <textarea id="app-desc-${lang}"
                                      placeholder="App description">${app.description?.[lang] || ''}</textarea>
                        </div>
                    `).join('')}
                </div>
            `;

            document.getElementById('app-modal').classList.add('active');
        }

        function saveApp() {
            if (currentAppIndex === -1) return;

            const app = homepageContent.apps[currentAppIndex];
            app.icon = document.getElementById('app-icon').value;
            app.url = document.getElementById('app-url').value;
            app.category = document.getElementById('app-category').value;
            app.tier = document.getElementById('app-tier').value;

            if (!app.name) app.name = {};
            if (!app.description) app.description = {};

            languages.forEach(lang => {
                app.name[lang] = document.getElementById(`app-name-${lang}`).value;
                app.description[lang] = document.getElementById(`app-desc-${lang}`).value;
            });

            renderAppsSection();
            closeAppModal();
            showMessage('App updated', 'success');
        }

        function closeAppModal() {
            document.getElementById('app-modal').classList.remove('active');
            currentAppIndex = -1;
        }

        function addApp() {
            const newApp = {
                icon: 'üìù',
                name: { en: 'New App' },
                description: { en: 'App description' },
                url: '/worksheet-generators/new-app.html',
                category: 'Math',
                tier: 'core',
                sort_order: homepageContent.apps ? homepageContent.apps.length + 1 : 1
            };
            if (!homepageContent.apps) homepageContent.apps = [];
            homepageContent.apps.push(newApp);
            renderAppsSection();
            editApp(homepageContent.apps.length - 1);
        }

        function deleteApp(index) {
            if (confirm('Delete this app?')) {
                homepageContent.apps.splice(index, 1);
                renderAppsSection();
                showMessage('App deleted', 'success');
            }
        }

        // Footer update functions
        function updateFooterField(field, lang, value) {
            if (!homepageContent.footer) homepageContent.footer = {};
            if (!homepageContent.footer[field]) homepageContent.footer[field] = {};
            homepageContent.footer[field][lang] = value;
        }

        function updateFooterSectionTitle(section, lang, value) {
            if (!homepageContent.footer.sections) homepageContent.footer.sections = {};
            if (!homepageContent.footer.sections[section]) homepageContent.footer.sections[section] = {};
            if (!homepageContent.footer.sections[section].title) homepageContent.footer.sections[section].title = {};
            homepageContent.footer.sections[section].title[lang] = value;
        }

        function updateFooterSectionLink(section, link, lang, value) {
            if (!homepageContent.footer.sections[section].links) homepageContent.footer.sections[section].links = {};
            if (!homepageContent.footer.sections[section].links[link]) homepageContent.footer.sections[section].links[link] = {};
            homepageContent.footer.sections[section].links[link][lang] = value;
        }

        // Render navigation section
        function renderNavigationSection() {
            if (!homepageContent.navigation) return;

            // Logo text input
            const logoText = homepageContent.navigation.logo?.text || 'LessonCraftStudio';
            const logoTextInput = document.getElementById('nav-logo-text');
            if (logoTextInput) logoTextInput.value = logoText;

            // Display logo image if exists
            if (homepageContent.navigation.logo?.image) {
                const logoPreview = document.getElementById('logo-preview');
                if (logoPreview) {
                    logoPreview.innerHTML = `
                        <div class="image-preview-container">
                            <img src="${homepageContent.navigation.logo.image}" alt="Logo" class="image-preview">
                            <button class="image-remove" onclick="removeLogo()">&times;</button>
                        </div>
                    `;
                    uploadedImages.logo = homepageContent.navigation.logo.image;
                }
            }

            // Render menu items
            const menuContainer = document.getElementById('menu-items-container');
            if (menuContainer) {
                menuContainer.innerHTML = '';
                if (homepageContent.navigation.menuItems) {
                    Object.entries(homepageContent.navigation.menuItems).forEach(([key, translations]) => {
                        const menuItemDiv = document.createElement('div');
                        menuItemDiv.className = 'card';
                        menuItemDiv.innerHTML = `
                            <h4>${key.charAt(0).toUpperCase() + key.slice(1)}</h4>
                            <div class="grid-2">
                                ${languages.map(lang => `
                                    <div class="form-group">
                                        <label>${languageNames[lang]}</label>
                                        <input type="text" value="${translations[lang] || ''}"
                                               id="menu-${key}-${lang}" placeholder="${key}">
                                    </div>
                                `).join('')}
                            </div>
                        `;
                        menuContainer.appendChild(menuItemDiv);
                    });
                }
            }

            // Render nav buttons
            const buttonsContainer = document.getElementById('nav-buttons-container');
            if (buttonsContainer) {
                buttonsContainer.innerHTML = '';
                if (homepageContent.navigation.buttons) {
                    Object.entries(homepageContent.navigation.buttons).forEach(([key, translations]) => {
                        const buttonDiv = document.createElement('div');
                        buttonDiv.className = 'card';
                        buttonDiv.innerHTML = `
                            <h4>${key.charAt(0).toUpperCase() + key.slice(1)} Button</h4>
                            <div class="grid-2">
                                ${languages.map(lang => `
                                    <div class="form-group">
                                        <label>${languageNames[lang]}</label>
                                        <input type="text" value="${translations[lang] || ''}"
                                               id="button-${key}-${lang}" placeholder="${key}">
                                    </div>
                                `).join('')}
                            </div>
                        `;
                        buttonsContainer.appendChild(buttonDiv);
                    });
                }
            }
        }

        function renderHeroSection() {
            console.log('renderHeroSection called');
            console.log('homepageContent.hero:', homepageContent.hero);

            if (!homepageContent.hero) {
                console.error('ERROR: homepageContent.hero is missing!');
                return;
            }

            languages.forEach(lang => {
                const titleEl = document.getElementById(`hero-title-${lang}`);
                const subtitleEl = document.getElementById(`hero-subtitle-${lang}`);
                const primaryEl = document.getElementById(`hero-cta-primary-${lang}`);
                const secondaryEl = document.getElementById(`hero-cta-secondary-${lang}`);

                console.log(`Setting ${lang} values:`, {
                    title: homepageContent.hero.title?.[lang],
                    titleElExists: !!titleEl
                });

                if (titleEl) titleEl.value = homepageContent.hero.title?.[lang] || '';
                if (subtitleEl) subtitleEl.value = homepageContent.hero.subtitle?.[lang] || '';
                if (primaryEl) primaryEl.value = homepageContent.hero.cta_primary_text?.[lang] || '';
                if (secondaryEl) secondaryEl.value = homepageContent.hero.cta_secondary_text?.[lang] || '';
            });
            console.log('renderHeroSection completed');
        }

        function renderSamplesSection() {
            // Update headers
            if (homepageContent.samplesSection) {
                languages.forEach(lang => {
                    const titleEl = document.getElementById(`samples-title-${lang}`);
                    const subtitleEl = document.getElementById(`samples-subtitle-${lang}`);
                    const ctaEl = document.getElementById(`samples-cta-${lang}`);

                    if (titleEl) titleEl.value = homepageContent.samplesSection.title?.[lang] || '';
                    if (subtitleEl) subtitleEl.value = homepageContent.samplesSection.subtitle?.[lang] || '';
                    if (ctaEl) ctaEl.value = homepageContent.samplesSection.cta?.[lang] || '';

                    // Update categories
                    ['math', 'literacy', 'puzzle', 'logic', 'creative'].forEach(cat => {
                        const catEl = document.getElementById(`category-${cat}-${lang}`);
                        if (catEl) catEl.value = homepageContent.samplesSection.categories?.[cat]?.[lang] || '';
                    });

                    // Update difficulties
                    ['easy', 'medium', 'hard'].forEach(diff => {
                        const diffEl = document.getElementById(`difficulty-${diff}-${lang}`);
                        if (diffEl) diffEl.value = homepageContent.samplesSection.difficulties?.[diff]?.[lang] || '';
                    });

                    // Update modal labels
                    const ageRangeEl = document.getElementById(`modal-age-range-${lang}`);
                    const modalDiffEl = document.getElementById(`modal-difficulty-${lang}`);
                    const modalCatEl = document.getElementById(`modal-category-${lang}`);

                    if (ageRangeEl) ageRangeEl.value = homepageContent.samplesSection.modalLabels?.ageRange?.[lang] || '';
                    if (modalDiffEl) modalDiffEl.value = homepageContent.samplesSection.modalLabels?.difficulty?.[lang] || '';
                    if (modalCatEl) modalCatEl.value = homepageContent.samplesSection.modalLabels?.category?.[lang] || '';
                });
            }

            // Update samples list
            const container = document.getElementById('samples-list');
            if (container) {
                container.innerHTML = '';
                (homepageContent.samples || []).forEach((sample, index) => {
                    const card = createSampleCard(sample, index);
                    container.appendChild(card);
                });

                // Initialize Sortable.js for drag-and-drop
                initializeSamplesSortable();
            }
        }

        // Initialize drag-and-drop for worksheet samples
        let samplesSortable = null;

        function initializeSamplesSortable() {
            const container = document.getElementById('samples-list');
            if (!container) return;

            // Destroy existing sortable if it exists
            if (samplesSortable) {
                samplesSortable.destroy();
            }

            // Initialize new sortable
            samplesSortable = new Sortable(container, {
                animation: 200,
                handle: '.drag-handle',
                ghostClass: 'sortable-ghost',
                dragClass: 'sortable-drag',
                onStart: function() {
                    container.classList.add('sortable-dragging');
                },
                onEnd: function(evt) {
                    container.classList.remove('sortable-dragging');

                    // Update the samples array order
                    const oldIndex = evt.oldIndex;
                    const newIndex = evt.newIndex;

                    if (oldIndex !== newIndex) {
                        // Reorder the samples array
                        const movedSample = homepageContent.samples.splice(oldIndex, 1)[0];
                        homepageContent.samples.splice(newIndex, 0, movedSample);

                        // Update sort_order for all samples
                        homepageContent.samples.forEach((sample, index) => {
                            sample.sort_order = index;
                        });

                        // Re-render to update indices in buttons
                        renderSamplesSection();

                        showMessage(`Sample reordered! Don't forget to click "üíæ Save All Content" to persist changes.`, 'info');
                    }
                }
            });
        }

        function renderTranslationsSection() {
            if (!homepageContent.commonUI) return;

            languages.forEach(lang => {
                const fields = [
                    { key: 'loading', id: 'loading' },
                    { key: 'error', id: 'error' },
                    { key: 'success', id: 'success' },
                    { key: 'noResults', id: 'no-results' },
                    { key: 'viewMore', id: 'view-more' },
                    { key: 'viewLess', id: 'view-less' },
                    { key: 'search', id: 'search' },
                    { key: 'filter', id: 'filter' }
                ];

                fields.forEach(field => {
                    const el = document.getElementById(`ui-${field.id}-${lang}`);
                    if (el) el.value = homepageContent.commonUI[field.key]?.[lang] || '';
                });
            });
        }

        function renderSEOSection() {
            if (!homepageContent.seo) return;

            languages.forEach(lang => {
                const titleEl = document.getElementById(`seo-title-${lang}`);
                const descEl = document.getElementById(`seo-description-${lang}`);
                const keywordsEl = document.getElementById(`seo-keywords-${lang}`);

                if (titleEl) titleEl.value = homepageContent.seo.title?.[lang] || '';
                if (descEl) descEl.value = homepageContent.seo.description?.[lang] || '';
                if (keywordsEl) keywordsEl.value = homepageContent.seo.keywords?.[lang] || '';
            });
        }

        // Create sample card
        function createSampleCard(sample, index) {
            const card = document.createElement('div');
            card.className = 'sample-card';

            const categoryBadgeClass = {
                math: 'badge-blue',
                literacy: 'badge-green',
                puzzle: 'badge-purple',
                logic: 'badge-yellow',
                creative: 'badge-red'
            }[sample.category] || 'badge-blue';

            const difficultyBadgeClass = {
                easy: 'badge-green',
                medium: 'badge-yellow',
                hard: 'badge-red'
            }[sample.difficulty] || 'badge-green';

            card.setAttribute('data-sample-id', sample.id || `sample-${index}`);
            card.setAttribute('data-index', index);

            card.innerHTML = `
                <div class="drag-handle" title="Drag to reorder">‚ãÆ‚ãÆ</div>
                <div class="sample-image-container">
                    <img src="${sample.image_url || '/api/placeholder/250/180'}" alt="${sample.name?.en}" class="sample-image">
                </div>
                <div class="sample-content">
                    <div class="sample-title">${sample.name?.en || 'Untitled'}</div>
                    <div class="sample-description">${sample.description?.en || 'No description'}</div>
                    <div class="sample-meta">
                        <span class="badge ${categoryBadgeClass}">${sample.category}</span>
                        <span class="badge ${difficultyBadgeClass}">${sample.difficulty}</span>
                        <span class="badge badge-blue">${sample.age_range?.en || '5-7 years'}</span>
                    </div>
                    <div style="display: flex; gap: 5px;">
                        <button class="btn btn-small btn-primary" onclick="editSample(${index})">Edit</button>
                        <button class="btn btn-small btn-danger" onclick="deleteSample(${index})">Delete</button>
                    </div>
                </div>
            `;
            return card;
        }

        // Sample management functions
        let currentEditingSample = null;
        let uploadedImages = { logo: null, sample: null };

        function editSample(index) {
            currentEditingSample = { ...homepageContent.samples[index], index };

            // Create and show the sample edit modal
            showSampleEditModal(currentEditingSample);
        }

        function showSampleEditModal(sample) {
            // Create modal if it doesn't exist
            let modal = document.getElementById('sample-edit-modal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'sample-edit-modal';
                modal.className = 'modal';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 1000px;">
                        <div class="modal-header">
                            <h3>Edit Worksheet Sample</h3>
                            <button class="modal-close" onclick="closeSampleEditModal()">&times;</button>
                        </div>
                        <div class="modal-body" id="sample-modal-body">
                            <!-- Content will be inserted here -->
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" onclick="closeSampleEditModal()">Cancel</button>
                            <button class="btn btn-success" onclick="saveSampleEdit()">Save Sample</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            // Populate modal content
            const modalBody = document.getElementById('sample-modal-body');
            modalBody.innerHTML = `
                <div class="form-group">
                    <label>Category</label>
                    <select id="edit-sample-category">
                        <option value="math" ${sample.category === 'math' ? 'selected' : ''}>Math</option>
                        <option value="literacy" ${sample.category === 'literacy' ? 'selected' : ''}>Literacy</option>
                        <option value="puzzle" ${sample.category === 'puzzle' ? 'selected' : ''}>Puzzle</option>
                        <option value="logic" ${sample.category === 'logic' ? 'selected' : ''}>Logic</option>
                        <option value="creative" ${sample.category === 'creative' ? 'selected' : ''}>Creative</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Difficulty</label>
                    <select id="edit-sample-difficulty">
                        <option value="easy" ${sample.difficulty === 'easy' ? 'selected' : ''}>Easy</option>
                        <option value="medium" ${sample.difficulty === 'medium' ? 'selected' : ''}>Medium</option>
                        <option value="hard" ${sample.difficulty === 'hard' ? 'selected' : ''}>Hard</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Featured</label>
                    <input type="checkbox" id="edit-sample-featured" ${sample.featured ? 'checked' : ''}>
                </div>
                <div class="form-group">
                    <label>Image URL</label>
                    <input type="text" id="edit-sample-image" value="${sample.image_url || ''}" placeholder="/worksheet-samples/example.png">
                </div>
                <div class="form-group">
                    <label>Or Upload Image</label>
                    <input type="file" id="edit-sample-image-upload" accept="image/*" onchange="handleSampleImageUpload(event, ${sample.index})">
                    <div id="edit-sample-image-preview" style="margin-top: 10px;">
                        ${sample.image_url ? `<img src="${sample.image_url}" alt="Preview" style="max-width: 200px; max-height: 200px; border: 1px solid #ddd; border-radius: 4px;">` : ''}
                    </div>
                </div>

                <h4>Name (All Languages)</h4>
                <div class="grid-3">
                    ${languages.map(lang => `
                        <div class="form-group">
                            <label>${languageNames[lang]}</label>
                            <input type="text" id="edit-sample-name-${lang}"
                                   value="${sample.name?.[lang] || ''}"
                                   placeholder="Sample name in ${languageNames[lang]}">
                        </div>
                    `).join('')}
                </div>

                <h4>Description (All Languages)</h4>
                <div class="grid-2">
                    ${languages.map(lang => `
                        <div class="form-group">
                            <label>${languageNames[lang]}</label>
                            <textarea id="edit-sample-desc-${lang}" rows="3"
                                      placeholder="Description in ${languageNames[lang]}">${sample.description?.[lang] || ''}</textarea>
                        </div>
                    `).join('')}
                </div>

                <h4>Age Range (All Languages)</h4>
                <div class="grid-3">
                    ${languages.map(lang => `
                        <div class="form-group">
                            <label>${languageNames[lang]}</label>
                            <input type="text" id="edit-sample-age-${lang}"
                                   value="${sample.age_range?.[lang] || sample.age_range || ''}"
                                   placeholder="e.g., 5-7 years">
                        </div>
                    `).join('')}
                </div>
            `;

            modal.classList.add('active');
        }

        function closeSampleEditModal() {
            const modal = document.getElementById('sample-edit-modal');
            if (modal) {
                modal.classList.remove('active');
                currentEditingSample = null;
            }
        }

        async function saveSampleEdit() {
            if (!currentEditingSample) {
                console.error('No sample being edited');
                return;
            }

            const index = currentEditingSample.index;
            console.log('Saving sample at index:', index);

            // Get the image URL and check if it's Base64
            let imageUrl = document.getElementById('edit-sample-image').value;

            // If image URL is Base64, upload it to the server first
            if (imageUrl && imageUrl.startsWith('data:')) {
                console.log('Detected Base64 image, uploading to server...');
                try {
                    showLoading(true);
                    const imageFile = base64ToFile(imageUrl, `sample-${index + 1}.png`);
                    imageUrl = await uploadImageToServer(imageFile);
                    console.log('Base64 image uploaded successfully:', imageUrl);

                    // Update the input field with the new path
                    document.getElementById('edit-sample-image').value = imageUrl;

                    showLoading(false);
                } catch (error) {
                    showLoading(false);
                    console.error('Failed to upload Base64 image:', error);
                    showMessage(`Failed to upload image: ${error.message}`, 'error');
                    return;
                }
            }

            const updatedSample = {
                id: currentEditingSample.id || `sample-${index + 1}`,
                sort_order: currentEditingSample.sort_order !== undefined ? currentEditingSample.sort_order : index,
                category: document.getElementById('edit-sample-category').value,
                difficulty: document.getElementById('edit-sample-difficulty').value,
                featured: document.getElementById('edit-sample-featured').checked,
                image_url: imageUrl,
                name: {},
                description: {},
                age_range: {}
            };

            // Collect all language data
            languages.forEach(lang => {
                updatedSample.name[lang] = document.getElementById(`edit-sample-name-${lang}`).value;
                updatedSample.description[lang] = document.getElementById(`edit-sample-desc-${lang}`).value;
                updatedSample.age_range[lang] = document.getElementById(`edit-sample-age-${lang}`).value;
            });

            console.log('Updated sample:', updatedSample);

            // Update the sample in the main content
            homepageContent.samples[index] = updatedSample;

            // Save to API - only save the samples section
            showLoading(true);
            try {
                console.log('Sending POST request to /api/homepage/content (samples only)');
                const response = await fetch('/api/homepage/content', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        section: 'samples',
                        content: {
                            samples: homepageContent.samples
                        }
                    })
                });

                console.log('Response status:', response.status);

                if (response.ok) {
                    const result = await response.json();
                    console.log('Save successful:', result);
                    // Re-render the samples section
                    renderSamplesSection();
                    closeSampleEditModal();
                    showMessage('Sample saved successfully!', 'success');
                } else {
                    const error = await response.text();
                    console.error('Save failed with status', response.status, ':', error);
                    showMessage(`Failed to save sample: ${error}`, 'error');
                }
            } catch (error) {
                console.error('Save error (exception):', error);
                showMessage(`Error saving sample: ${error.message}`, 'error');
            } finally {
                showLoading(false);
            }
        }

        function deleteSample(index) {
            if (confirm('Are you sure you want to delete this sample?')) {
                homepageContent.samples.splice(index, 1);
                renderSamplesSection();
                showMessage('Sample deleted', 'success');
            }
        }

        // Helper functions
        function removeLogo() {
            const logoPreview = document.getElementById('logo-preview');
            if (logoPreview) logoPreview.innerHTML = '';
            uploadedImages.logo = null;
            if (homepageContent.navigation?.logo) {
                homepageContent.navigation.logo.image = '';
            }
        }

        // Helper function to convert Base64 data URL to File object
        function base64ToFile(base64String, filename = 'image.png') {
            // Check if it's a Base64 data URL
            if (!base64String.startsWith('data:')) {
                return null;
            }

            // Extract MIME type and Base64 data
            const arr = base64String.split(',');
            const mime = arr[0].match(/:(.*?);/)[1];
            const bstr = atob(arr[1]);
            let n = bstr.length;
            const u8arr = new Uint8Array(n);

            while(n--){
                u8arr[n] = bstr.charCodeAt(n);
            }

            return new File([u8arr], filename, {type: mime});
        }

        // Helper function to upload image to server and get file path
        async function uploadImageToServer(file) {
            const formData = new FormData();
            formData.append('file', file);

            try {
                showLoading(true);
                const response = await fetch('/api/homepage/samples/upload', {
                    method: 'POST',
                    body: formData,
                    credentials: 'include' // Include cookies for authentication
                });

                showLoading(false);

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || 'Upload failed');
                }

                const result = await response.json();
                console.log('Image uploaded successfully:', result);
                return result.path; // Returns path like "/worksheet-samples/image-123456.webp"
            } catch (error) {
                showLoading(false);
                console.error('Upload error:', error);
                throw error;
            }
        }

        function handleLogoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            // Upload to server and get file path (no more Base64!)
            uploadImageToServer(file)
                .then(imagePath => {
                    const logoPreview = document.getElementById('logo-preview');
                    if (logoPreview) {
                        logoPreview.innerHTML = `
                            <div class="image-preview-container">
                                <img src="${imagePath}" alt="Logo" class="image-preview">
                                <button class="image-remove" onclick="removeLogo()">&times;</button>
                            </div>
                        `;
                        uploadedImages.logo = imagePath; // Store file path, not Base64
                    }
                    showMessage('Logo uploaded successfully', 'success');
                })
                .catch(error => {
                    console.error('Logo upload failed:', error);
                    showMessage('Failed to upload logo: ' + error.message, 'error');
                });
        }

        function handleSampleImageUpload(event, sampleIndex) {
            const file = event.target.files[0];
            if (!file) return;

            // Upload to server and get file path (no more Base64!)
            uploadImageToServer(file)
                .then(imagePath => {
                    // Update the image URL input with file path
                    document.getElementById('edit-sample-image').value = imagePath;

                    // Update the preview
                    const previewDiv = document.getElementById('edit-sample-image-preview');
                    if (previewDiv) {
                        previewDiv.innerHTML = `
                            <img src="${imagePath}" alt="Preview" style="max-width: 200px; max-height: 200px; border: 1px solid #ddd; border-radius: 4px;">
                        `;
                    }
                    showMessage('Sample image uploaded successfully', 'success');
                })
                .catch(error => {
                    console.error('Sample image upload failed:', error);
                    showMessage('Failed to upload sample image: ' + error.message, 'error');
                });
        }

        function switchLanguage(section, lang) {
            // Update tab active state
            const tabContainer = event.target.parentElement;
            tabContainer.querySelectorAll('.lang-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Show corresponding content
            document.querySelectorAll(`[id^="${section}-content-"]`).forEach(content => {
                content.classList.remove('active');
            });
            const targetContent = document.getElementById(`${section}-content-${lang}`);
            if (targetContent) targetContent.classList.add('active');
        }

        function addFeature() {
            const newFeature = {
                icon: 'apps',
                title: { en: 'New Feature' },
                description: { en: 'Feature description' },
                color_scheme: 'primary',
                sort_order: homepageContent.features.length + 1
            };
            homepageContent.features.push(newFeature);
            renderFeaturesSection();
            editFeature(homepageContent.features.length - 1);
        }

        function openSampleModal() {
            alert('Sample modal coming soon - for now, samples can be edited inline');
        }

        function showMessage(text, type = 'info') {
            const existingMessage = document.querySelector('.message');
            if (existingMessage) existingMessage.remove();

            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.textContent = text;
            document.body.appendChild(message);

            setTimeout(() => message.classList.add('show'), 10);
            setTimeout(() => {
                message.classList.remove('show');
                setTimeout(() => message.remove(), 300);
            }, 3000);
        }

        function showLoading(show) {
            let overlay = document.getElementById('loadingOverlay');
            if (!overlay) {
                overlay = document.createElement('div');
                overlay.id = 'loadingOverlay';
                overlay.innerHTML = '<div class="spinner"></div>';
                document.body.appendChild(overlay);
            }
            overlay.classList.toggle('show', show);
        }

        // Collect all form data before saving
        function collectAllFormData() {
            // Collect Navigation data
            if (!homepageContent.navigation) homepageContent.navigation = { logo: {}, menuItems: {}, buttons: {} };
            homepageContent.navigation.logo.text = document.getElementById('nav-logo-text')?.value || '';
            if (uploadedImages.logo) {
                homepageContent.navigation.logo.image = uploadedImages.logo;
            }

            // Collect menu items
            const menuItems = {};
            document.querySelectorAll('[id^="menu-"]').forEach(input => {
                const match = input.id.match(/menu-(.+)-(.+)/);
                if (match) {
                    const [, key, lang] = match;
                    if (!menuItems[key]) menuItems[key] = {};
                    menuItems[key][lang] = input.value;
                }
            });
            if (Object.keys(menuItems).length > 0) {
                homepageContent.navigation.menuItems = menuItems;
            }

            // Collect buttons
            const buttons = {};
            document.querySelectorAll('[id^="button-"]').forEach(input => {
                const match = input.id.match(/button-(.+)-(.+)/);
                if (match) {
                    const [, key, lang] = match;
                    if (!buttons[key]) buttons[key] = {};
                    buttons[key][lang] = input.value;
                }
            });
            if (Object.keys(buttons).length > 0) {
                homepageContent.navigation.buttons = buttons;
            }

            // Collect Hero section
            if (!homepageContent.hero) homepageContent.hero = {};
            languages.forEach(lang => {
                const titleEl = document.getElementById(`hero-title-${lang}`);
                const subtitleEl = document.getElementById(`hero-subtitle-${lang}`);
                const primaryEl = document.getElementById(`hero-cta-primary-${lang}`);
                const secondaryEl = document.getElementById(`hero-cta-secondary-${lang}`);

                if (!homepageContent.hero.title) homepageContent.hero.title = {};
                if (!homepageContent.hero.subtitle) homepageContent.hero.subtitle = {};
                if (!homepageContent.hero.cta_primary_text) homepageContent.hero.cta_primary_text = {};
                if (!homepageContent.hero.cta_secondary_text) homepageContent.hero.cta_secondary_text = {};

                if (titleEl) homepageContent.hero.title[lang] = titleEl.value;
                if (subtitleEl) homepageContent.hero.subtitle[lang] = subtitleEl.value;
                if (primaryEl) homepageContent.hero.cta_primary_text[lang] = primaryEl.value;
                if (secondaryEl) homepageContent.hero.cta_secondary_text[lang] = secondaryEl.value;
            });

            // Collect Features section headers
            if (!homepageContent.featuresSection) homepageContent.featuresSection = {};
            languages.forEach(lang => {
                const titleEl = document.getElementById(`features-title-${lang}`);
                const subtitleEl = document.getElementById(`features-subtitle-${lang}`);

                if (!homepageContent.featuresSection.title) homepageContent.featuresSection.title = {};
                if (!homepageContent.featuresSection.subtitle) homepageContent.featuresSection.subtitle = {};

                if (titleEl) homepageContent.featuresSection.title[lang] = titleEl.value;
                if (subtitleEl) homepageContent.featuresSection.subtitle[lang] = subtitleEl.value;
            });

            // Collect Apps section
            if (!homepageContent.appsSection) homepageContent.appsSection = { categories: {}, tierNames: {} };
            languages.forEach(lang => {
                const titleEl = document.getElementById(`apps-title-${lang}`);
                const subtitleEl = document.getElementById(`apps-subtitle-${lang}`);

                if (!homepageContent.appsSection.title) homepageContent.appsSection.title = {};
                if (!homepageContent.appsSection.subtitle) homepageContent.appsSection.subtitle = {};

                if (titleEl) homepageContent.appsSection.title[lang] = titleEl.value;
                if (subtitleEl) homepageContent.appsSection.subtitle[lang] = subtitleEl.value;

                // Collect categories
                ['Math', 'Language', 'Logic', 'Art', 'Visual', 'Game'].forEach(cat => {
                    const catEl = document.getElementById(`app-category-${cat}-${lang}`);
                    if (catEl) {
                        if (!homepageContent.appsSection.categories[cat]) homepageContent.appsSection.categories[cat] = {};
                        homepageContent.appsSection.categories[cat][lang] = catEl.value;
                    }
                });

                // Collect tier names
                ['free', 'core', 'full'].forEach(tier => {
                    const tierEl = document.getElementById(`app-tier-${tier}-${lang}`);
                    if (tierEl) {
                        if (!homepageContent.appsSection.tierNames[tier]) homepageContent.appsSection.tierNames[tier] = {};
                        homepageContent.appsSection.tierNames[tier][lang] = tierEl.value;
                    }
                });
            });

            // Collect Samples section
            if (!homepageContent.samplesSection) homepageContent.samplesSection = { categories: {}, difficulties: {}, modalLabels: {} };
            languages.forEach(lang => {
                const titleEl = document.getElementById(`samples-title-${lang}`);
                const subtitleEl = document.getElementById(`samples-subtitle-${lang}`);
                const ctaEl = document.getElementById(`samples-cta-${lang}`);

                if (!homepageContent.samplesSection.title) homepageContent.samplesSection.title = {};
                if (!homepageContent.samplesSection.subtitle) homepageContent.samplesSection.subtitle = {};
                if (!homepageContent.samplesSection.cta) homepageContent.samplesSection.cta = {};

                if (titleEl) homepageContent.samplesSection.title[lang] = titleEl.value;
                if (subtitleEl) homepageContent.samplesSection.subtitle[lang] = subtitleEl.value;
                if (ctaEl) homepageContent.samplesSection.cta[lang] = ctaEl.value;

                // Collect categories
                ['math', 'literacy', 'puzzle', 'logic', 'creative'].forEach(cat => {
                    const catEl = document.getElementById(`category-${cat}-${lang}`);
                    if (catEl) {
                        if (!homepageContent.samplesSection.categories[cat]) homepageContent.samplesSection.categories[cat] = {};
                        homepageContent.samplesSection.categories[cat][lang] = catEl.value;
                    }
                });

                // Collect difficulties
                ['easy', 'medium', 'hard'].forEach(diff => {
                    const diffEl = document.getElementById(`difficulty-${diff}-${lang}`);
                    if (diffEl) {
                        if (!homepageContent.samplesSection.difficulties[diff]) homepageContent.samplesSection.difficulties[diff] = {};
                        homepageContent.samplesSection.difficulties[diff][lang] = diffEl.value;
                    }
                });
            });

            // Collect Pricing section headers
            if (!homepageContent.pricingSection) homepageContent.pricingSection = { periods: {} };
            languages.forEach(lang => {
                const titleEl = document.getElementById(`pricing-title-${lang}`);
                if (titleEl) {
                    if (!homepageContent.pricingSection.title) homepageContent.pricingSection.title = {};
                    homepageContent.pricingSection.title[lang] = titleEl.value;
                }
            });

            // Collect Footer data
            if (!homepageContent.footer) homepageContent.footer = {};
            languages.forEach(lang => {
                const companyEl = document.getElementById(`footer-company-${lang}`);
                const taglineEl = document.getElementById(`footer-tagline-${lang}`);
                const copyrightEl = document.getElementById(`footer-copyright-${lang}`);

                if (!homepageContent.footer.companyName) homepageContent.footer.companyName = {};
                if (!homepageContent.footer.companyTagline) homepageContent.footer.companyTagline = {};
                if (!homepageContent.footer.copyright) homepageContent.footer.copyright = {};

                if (companyEl) homepageContent.footer.companyName[lang] = companyEl.value;
                if (taglineEl) homepageContent.footer.companyTagline[lang] = taglineEl.value;
                if (copyrightEl) homepageContent.footer.copyright[lang] = copyrightEl.value;
            });

            // Collect Common UI translations
            if (!homepageContent.commonUI) homepageContent.commonUI = {};
            const uiFields = [
                { key: 'loading', id: 'loading' },
                { key: 'error', id: 'error' },
                { key: 'success', id: 'success' },
                { key: 'noResults', id: 'no-results' },
                { key: 'viewMore', id: 'view-more' },
                { key: 'viewLess', id: 'view-less' },
                { key: 'search', id: 'search' },
                { key: 'filter', id: 'filter' }
            ];

            languages.forEach(lang => {
                uiFields.forEach(field => {
                    const el = document.getElementById(`ui-${field.id}-${lang}`);
                    if (el) {
                        if (!homepageContent.commonUI[field.key]) homepageContent.commonUI[field.key] = {};
                        homepageContent.commonUI[field.key][lang] = el.value;
                    }
                });
            });

            // Collect SEO data
            if (!homepageContent.seo) homepageContent.seo = {};
            languages.forEach(lang => {
                const titleEl = document.getElementById(`seo-title-${lang}`);
                const descEl = document.getElementById(`seo-description-${lang}`);
                const keywordsEl = document.getElementById(`seo-keywords-${lang}`);

                if (!homepageContent.seo.title) homepageContent.seo.title = {};
                if (!homepageContent.seo.description) homepageContent.seo.description = {};
                if (!homepageContent.seo.keywords) homepageContent.seo.keywords = {};

                if (titleEl) homepageContent.seo.title[lang] = titleEl.value;
                if (descEl) homepageContent.seo.description[lang] = descEl.value;
                if (keywordsEl) homepageContent.seo.keywords[lang] = keywordsEl.value;
            });

            return homepageContent;
        }

        // Save functionality
        async function saveAllContent() {
            showLoading(true);
            try {
                // CRITICAL: Collect all form data before saving!
                const updatedContent = collectAllFormData();
                console.log('Saving content:', updatedContent);

                const response = await fetch('/api/homepage/content', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        section: 'all',
                        content: updatedContent
                    })
                });

                if (response.ok) {
                    showMessage('All changes saved successfully!', 'success');
                } else {
                    const error = await response.text();
                    console.error('Save failed:', error);
                    showMessage('Failed to save changes', 'error');
                }
            } catch (error) {
                console.error('Save error:', error);
                showMessage('Error saving changes', 'error');
            } finally {
                showLoading(false);
            }
        }

        // Utility functions
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.content-section').forEach(section => section.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(`${tabName}-section`).classList.add('active');
        }

        function showMessage(text, type) {
            const container = document.getElementById('message-container');
            container.innerHTML = `<div class="message ${type}">${text}</div>`;
            setTimeout(() => container.innerHTML = '', 3000);
        }
    </script>
</body>
</html>